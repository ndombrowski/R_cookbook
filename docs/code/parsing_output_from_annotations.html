<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Working with annotation data – R cookbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../code/2_misc.html" rel="next">
<link href="../code/plotting_basics.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-b663525e4b92bb903b2199e2d401bf36.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-699dbeaba9dd29303344692a4c1b088c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>



</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../code/parsing_output_from_annotations.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Working with annotation data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">R cookbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction into R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data objects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/data_transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data transformations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/control_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Control Structures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Statistics in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/plotting_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Basic plotting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/parsing_output_from_annotations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Working with annotation data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code/2_misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Miscellaneous</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-essential-packages" id="toc-load-essential-packages" class="nav-link active" data-scroll-target="#load-essential-packages"><span class="header-section-number">7.1</span> Load essential packages</a></li>
  <li><a href="#deal-with-the-mapping-file-for-our-genomes" id="toc-deal-with-the-mapping-file-for-our-genomes" class="nav-link" data-scroll-target="#deal-with-the-mapping-file-for-our-genomes"><span class="header-section-number">7.2</span> Deal with the mapping file for our genomes</a>
  <ul class="collapse">
  <li><a href="#load-mapping-file" id="toc-load-mapping-file" class="nav-link" data-scroll-target="#load-mapping-file"><span class="header-section-number">7.2.1</span> Load mapping file</a></li>
  </ul></li>
  <li><a href="#clean-mapping-file" id="toc-clean-mapping-file" class="nav-link" data-scroll-target="#clean-mapping-file"><span class="header-section-number">7.3</span> Clean mapping file</a></li>
  <li><a href="#generate-lists-to-order-dataframes" id="toc-generate-lists-to-order-dataframes" class="nav-link" data-scroll-target="#generate-lists-to-order-dataframes"><span class="header-section-number">7.4</span> Generate lists to order dataframes</a></li>
  <li><a href="#deal-with-mapping-files-for-the-annotations" id="toc-deal-with-mapping-files-for-the-annotations" class="nav-link" data-scroll-target="#deal-with-mapping-files-for-the-annotations"><span class="header-section-number">7.5</span> Deal with mapping files for the annotations</a>
  <ul class="collapse">
  <li><a href="#load-and-view-the-tables" id="toc-load-and-view-the-tables" class="nav-link" data-scroll-target="#load-and-view-the-tables"><span class="header-section-number">7.5.1</span> Load and view the tables</a></li>
  <li><a href="#make-a-vector-to-order-our-genes-of-interest" id="toc-make-a-vector-to-order-our-genes-of-interest" class="nav-link" data-scroll-target="#make-a-vector-to-order-our-genes-of-interest"><span class="header-section-number">7.5.2</span> Make a vector to order our genes of interest</a></li>
  </ul></li>
  <li><a href="#deal-with-annotation-file" id="toc-deal-with-annotation-file" class="nav-link" data-scroll-target="#deal-with-annotation-file"><span class="header-section-number">7.6</span> Deal with annotation file</a>
  <ul class="collapse">
  <li><a href="#read-in-table" id="toc-read-in-table" class="nav-link" data-scroll-target="#read-in-table"><span class="header-section-number">7.6.1</span> Read in table</a></li>
  <li><a href="#make-a-mapping-file-that-links-all-annotation-ids-to-their-descriptions" id="toc-make-a-mapping-file-that-links-all-annotation-ids-to-their-descriptions" class="nav-link" data-scroll-target="#make-a-mapping-file-that-links-all-annotation-ids-to-their-descriptions"><span class="header-section-number">7.6.2</span> Make a mapping file that links all annotation IDs to their descriptions</a></li>
  <li><a href="#parse-table-to-make-it-easier-to-work-with-it" id="toc-parse-table-to-make-it-easier-to-work-with-it" class="nav-link" data-scroll-target="#parse-table-to-make-it-easier-to-work-with-it"><span class="header-section-number">7.6.3</span> Parse table to make it easier to work with it</a></li>
  </ul></li>
  <li><a href="#make-count-tables" id="toc-make-count-tables" class="nav-link" data-scroll-target="#make-count-tables"><span class="header-section-number">7.7</span> Make count tables</a>
  <ul class="collapse">
  <li><a href="#generate-a-count-table-for-our-genomes-of-interest" id="toc-generate-a-count-table-for-our-genomes-of-interest" class="nav-link" data-scroll-target="#generate-a-count-table-for-our-genomes-of-interest"><span class="header-section-number">7.7.1</span> Generate a count table for our genomes of interest</a></li>
  <li><a href="#generate-a-count-table-for-our-clusters-of-interest" id="toc-generate-a-count-table-for-our-clusters-of-interest" class="nav-link" data-scroll-target="#generate-a-count-table-for-our-clusters-of-interest"><span class="header-section-number">7.7.2</span> Generate a count table for our clusters of interest</a></li>
  </ul></li>
  <li><a href="#merge-our-tables-with-the-mapping-data-we-have" id="toc-merge-our-tables-with-the-mapping-data-we-have" class="nav-link" data-scroll-target="#merge-our-tables-with-the-mapping-data-we-have"><span class="header-section-number">7.8</span> Merge our tables with the mapping data we have</a>
  <ul class="collapse">
  <li><a href="#for-the-bins" id="toc-for-the-bins" class="nav-link" data-scroll-target="#for-the-bins"><span class="header-section-number">7.8.1</span> For the bins</a></li>
  <li><a href="#for-the-clusters" id="toc-for-the-clusters" class="nav-link" data-scroll-target="#for-the-clusters"><span class="header-section-number">7.8.2</span> For the clusters</a></li>
  </ul></li>
  <li><a href="#plot-the-data-for-our-genes-of-interest" id="toc-plot-the-data-for-our-genes-of-interest" class="nav-link" data-scroll-target="#plot-the-data-for-our-genes-of-interest"><span class="header-section-number">7.9</span> Plot the data for our genes of interest</a>
  <ul class="collapse">
  <li><a href="#categorizing-data" id="toc-categorizing-data" class="nav-link" data-scroll-target="#categorizing-data"><span class="header-section-number">7.9.1</span> Categorizing data</a></li>
  <li><a href="#order-our-data" id="toc-order-our-data" class="nav-link" data-scroll-target="#order-our-data"><span class="header-section-number">7.9.2</span> Order our data</a></li>
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting"><span class="header-section-number">7.9.3</span> Plotting</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Working with annotation data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>As mentioned in the beginning section, if working with genomes we often have large lists of proteins and their annotations, often from different databases.</p>
<p>Here, we might be interested in condensing this information for each genome or for each phylum etc . OR we want to merge our data with other tables that are ordered differently. We might also want to plot the data to compare the presence absence levels of different genomes. This section with discuss how to do this in a step by step manner.</p>
<section id="load-essential-packages" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="load-essential-packages"><span class="header-section-number">7.1</span> Load essential packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | warning: false</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"plyr"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:plyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"grid"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gplots'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    lowess</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gridExtra"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"multcomp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: TH.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'TH.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"reshape2"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"RColorBrewer"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'tidyr'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:reshape2':

    smiths</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'tidyverse'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Attaching packages --------------------------------------- tidyverse 1.3.2 --</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>v tibble  3.1.8     v stringr 1.4.1
v readr   2.1.2     v forcats 0.5.2
v purrr   0.3.4     
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::arrange()     masks plyr::arrange()
x gridExtra::combine() masks dplyr::combine()
x purrr::compact()     masks plyr::compact()
x dplyr::count()       masks plyr::count()
x dplyr::failwith()    masks plyr::failwith()
x dplyr::filter()      masks stats::filter()
x dplyr::id()          masks plyr::id()
x dplyr::lag()         masks stats::lag()
x dplyr::mutate()      masks plyr::mutate()
x dplyr::rename()      masks plyr::rename()
x MASS::select()       masks dplyr::select()
x dplyr::summarise()   masks plyr::summarise()
x dplyr::summarize()   masks plyr::summarize()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'

The following object is masked from 'package:purrr':

    transpose

The following objects are masked from 'package:reshape2':

    dcast, melt

The following objects are masked from 'package:dplyr':

    between, first, last</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
</div>
</section>
<section id="deal-with-the-mapping-file-for-our-genomes" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="deal-with-the-mapping-file-for-our-genomes"><span class="header-section-number">7.2</span> Deal with the mapping file for our genomes</h2>
<section id="load-mapping-file" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="load-mapping-file"><span class="header-section-number">7.2.1</span> Load mapping file</h3>
<p>mapping file = a table that has the metadata for our genomes. In this specific example it lists our 46 DPANN genomes into clusters based on their phylogenetic placement.</p>
<p>We later want to summarize our data by individual bins and the phylogenetic clusters defined in the mapping file.</p>
<p>Notice: We can also sort our mapping file beforehand and use this order to order our tables, graph, etc…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read in the mapping file</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"../data/mapping.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header=</span>T, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">""</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#check the structure of the mapping file</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(design)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["BinID"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Cluster"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"NIOZ132_cc_b51_2","2":"Basal","_rn_":"1"},{"1":"NIOZ134_mx_b281_2","2":"Basal","_rn_":"2"},{"1":"SRR2090153_bin1042","2":"Aquifer","_rn_":"3"},{"1":"SRR2090153_bin461","2":"Aquifer","_rn_":"4"},{"1":"SRR2090159_bin1129","2":"Aquifer","_rn_":"5"},{"1":"SRR2090159_bin1288","2":"Aquifer","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="clean-mapping-file" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="clean-mapping-file"><span class="header-section-number">7.3</span> Clean mapping file</h2>
<p>Here, we want to add an extra column that summarizes how many genomes are in each phylogenetic cluster.</p>
<p>First lets summarize how many bins we have for each cluster:</p>
<ul>
<li><code>ddply()</code> = summarize our data by counting the number of bins we have in each cluster</li>
<li><code>order()</code> = next, we order our data based on the clusters with the greater number of bins</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add a new column that links the BinID and the taxonomic cluster</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>NewName2 <span class="ot">&lt;-</span><span class="fu">paste</span>(design<span class="sc">$</span>BinID, design<span class="sc">$</span>Cluster, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(design)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["BinID"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Cluster"],"name":[2],"type":["chr"],"align":["left"]},{"label":["NewName2"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"NIOZ132_cc_b51_2","2":"Basal","3":"NIOZ132_cc_b51_2-Basal","_rn_":"1"},{"1":"NIOZ134_mx_b281_2","2":"Basal","3":"NIOZ134_mx_b281_2-Basal","_rn_":"2"},{"1":"SRR2090153_bin1042","2":"Aquifer","3":"SRR2090153_bin1042-Aquifer","_rn_":"3"},{"1":"SRR2090153_bin461","2":"Aquifer","3":"SRR2090153_bin461-Aquifer","_rn_":"4"},{"1":"SRR2090159_bin1129","2":"Aquifer","3":"SRR2090159_bin1129-Aquifer","_rn_":"5"},{"1":"SRR2090159_bin1288","2":"Aquifer","3":"SRR2090159_bin1288-Aquifer","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#transform mapping file and summarize how many genomes we have/cluster</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>Number_of_taxa <span class="ot">&lt;-</span> <span class="fu">ddply</span>(design, .(Cluster), summarize, <span class="at">NrGenomes =</span> <span class="fu">length</span>(Cluster))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#order our data</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>Number_of_taxa <span class="ot">&lt;-</span> Number_of_taxa[<span class="fu">order</span>(Number_of_taxa<span class="sc">$</span>NrGenomes, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),] </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#view data</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Number_of_taxa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Cluster"],"name":[1],"type":["chr"],"align":["left"]},{"label":["NrGenomes"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Clade2","2":"23","_rn_":"4"},{"1":"Clade1","2":"11","_rn_":"3"},{"1":"Marine","2":"6","_rn_":"5"},{"1":"Aquifer","2":"4","_rn_":"1"},{"1":"Basal","2":"2","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Next, add this information into our original mapping file:</p>
<ul>
<li><code>paste()</code> = paste together different columns. With sep we can control what delimiter we want to use when combining info</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add a new column with the cluster count info into mapping file (then it can be added as a label into figures)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>design_2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(design, Number_of_taxa, <span class="at">by =</span> <span class="st">"Cluster"</span> )</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#view wether all went fine</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(design_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Cluster"],"name":[1],"type":["chr"],"align":["left"]},{"label":["BinID"],"name":[2],"type":["chr"],"align":["left"]},{"label":["NewName2"],"name":[3],"type":["chr"],"align":["left"]},{"label":["NrGenomes"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"Aquifer","2":"SRR2090153_bin1042","3":"SRR2090153_bin1042-Aquifer","4":"4","_rn_":"1"},{"1":"Aquifer","2":"SRR2090153_bin461","3":"SRR2090153_bin461-Aquifer","4":"4","_rn_":"2"},{"1":"Aquifer","2":"SRR2090159_bin1129","3":"SRR2090159_bin1129-Aquifer","4":"4","_rn_":"3"},{"1":"Aquifer","2":"SRR2090159_bin1288","3":"SRR2090159_bin1288-Aquifer","4":"4","_rn_":"4"},{"1":"Basal","2":"NIOZ132_cc_b51_2","3":"NIOZ132_cc_b51_2-Basal","4":"2","_rn_":"5"},{"1":"Basal","2":"NIOZ134_mx_b281_2","3":"NIOZ134_mx_b281_2-Basal","4":"2","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Next, let’s merge all relevant into one column using <code>paste()</code> again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a new column into the mapping file that links the cluster name with the number of genomes of clusters in each cluster</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>design_2<span class="sc">$</span>ClusterName <span class="ot">&lt;-</span> <span class="fu">paste</span>(design_2<span class="sc">$</span>Cluster, <span class="st">" ("</span>, design_2<span class="sc">$</span>NrGenomes, <span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#view data</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(design_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Cluster"],"name":[1],"type":["chr"],"align":["left"]},{"label":["BinID"],"name":[2],"type":["chr"],"align":["left"]},{"label":["NewName2"],"name":[3],"type":["chr"],"align":["left"]},{"label":["NrGenomes"],"name":[4],"type":["int"],"align":["right"]},{"label":["ClusterName"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Aquifer","2":"SRR2090153_bin1042","3":"SRR2090153_bin1042-Aquifer","4":"4","5":"Aquifer (4)","_rn_":"1"},{"1":"Aquifer","2":"SRR2090153_bin461","3":"SRR2090153_bin461-Aquifer","4":"4","5":"Aquifer (4)","_rn_":"2"},{"1":"Aquifer","2":"SRR2090159_bin1129","3":"SRR2090159_bin1129-Aquifer","4":"4","5":"Aquifer (4)","_rn_":"3"},{"1":"Aquifer","2":"SRR2090159_bin1288","3":"SRR2090159_bin1288-Aquifer","4":"4","5":"Aquifer (4)","_rn_":"4"},{"1":"Basal","2":"NIOZ132_cc_b51_2","3":"NIOZ132_cc_b51_2-Basal","4":"2","5":"Basal (2)","_rn_":"5"},{"1":"Basal","2":"NIOZ134_mx_b281_2","3":"NIOZ134_mx_b281_2-Basal","4":"2","5":"Basal (2)","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="generate-lists-to-order-dataframes" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="generate-lists-to-order-dataframes"><span class="header-section-number">7.4</span> Generate lists to order dataframes</h2>
<p>The default behaviour of a lot of R functions is to order data alphabetically but this is not what we might want. I.e. we want to order by different columns or simply order by the initial order in our mapping file. To do this it is useful to have vectors that are order our bins, clusters, etc… like we want them.</p>
<p>In this example the mapping file was ordered like this</p>
<ul>
<li>The basal group</li>
<li>Groups from an older dataset (marine and aquifer)</li>
<li>two black sea clades</li>
</ul>
<p>Lets first check, whether our new mapping file still has that order</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check the old data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>Cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Basal"   "Basal"   "Aquifer" "Aquifer" "Aquifer" "Aquifer" "Marine" 
 [8] "Marine"  "Marine"  "Marine"  "Marine"  "Marine"  "Clade1"  "Clade1" 
[15] "Clade1"  "Clade1"  "Clade1"  "Clade1"  "Clade1"  "Clade1"  "Clade1" 
[22] "Clade1"  "Clade1"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2" 
[29] "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2" 
[36] "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2" 
[43] "Clade2"  "Clade2"  "Clade2"  "Clade2" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check the new data</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>design_2<span class="sc">$</span>Cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Aquifer" "Aquifer" "Aquifer" "Aquifer" "Basal"   "Basal"   "Clade1" 
 [8] "Clade1"  "Clade1"  "Clade1"  "Clade1"  "Clade1"  "Clade1"  "Clade1" 
[15] "Clade1"  "Clade1"  "Clade1"  "Clade2"  "Clade2"  "Clade2"  "Clade2" 
[22] "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2" 
[29] "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2" 
[36] "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Marine"  "Marine" 
[43] "Marine"  "Marine"  "Marine"  "Marine" </code></pre>
</div>
</div>
<p>If we check the individual factors, we can see that the new dataframe is order by alphabet. Since this is not what we want, lets correct this</p>
<ul>
<li><code>match(design_2$BinID, design$BinID)</code> = We check what positions in design_2 match with design. Here, the first argument are the values to be matched and the second are the values to be matched against.</li>
<li><code>order()</code> = we reorder our dataframe based on the results from <code>match()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reorder our old dataframe by the original one</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>design_2 <span class="ot">&lt;-</span> design_2[ <span class="fu">order</span>(<span class="fu">match</span>(design_2<span class="sc">$</span>BinID, design<span class="sc">$</span>BinID)), ]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">#check, if the basal clade is now in the correct order</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>design_2<span class="sc">$</span>Cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Basal"   "Basal"   "Aquifer" "Aquifer" "Aquifer" "Aquifer" "Marine" 
 [8] "Marine"  "Marine"  "Marine"  "Marine"  "Marine"  "Clade1"  "Clade1" 
[15] "Clade1"  "Clade1"  "Clade1"  "Clade1"  "Clade1"  "Clade1"  "Clade1" 
[22] "Clade1"  "Clade1"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2" 
[29] "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2" 
[36] "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2"  "Clade2" 
[43] "Clade2"  "Clade2"  "Clade2"  "Clade2" </code></pre>
</div>
</div>
<p>Now, that the basal clade is in the first position, lets make vectors of the bins and clusters in order this we use:</p>
<ul>
<li><code>unique()</code> = we use unique on all ClusterNames in our mapping file. That way instead of having repeated names, we only have the unique ones</li>
<li><code>as.character()</code> = we make sure that our R object we generated is a character (so has words).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make a list to order our bins</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Bin_order <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unique</span>(design_2<span class="sc">$</span>BinID))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>Bin_order</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "NIOZ132_cc_b51_2"   "NIOZ134_mx_b281_2"  "SRR2090153_bin1042"
 [4] "SRR2090153_bin461"  "SRR2090159_bin1129" "SRR2090159_bin1288"
 [7] "GCA_002494525"      "GCA_002495465"      "GCA_002501985"     
[10] "SRR4028224_bin17"   "SRR5007147_bin71"   "U_76725"           
[13] "NIOZ124_cc_b247_2"  "NIOZ125_mb_b254_2"  "NIOZ129_mb_b262_2" 
[16] "NIOZ126_mb_b401_2"  "NIOZ122_mb_b319_2"  "NIOZ134_mb_b41_2"  
[19] "NIOZ132_mb_b282_2"  "NIOZ127_mb_b161_2"  "NIOZ123_bs_b5_2"   
[22] "NIOZ121_cc_b94_2"   "NIOZ136_cc_b15_2"   "GCA_002502135"     
[25] "NIOZ134_mb_b293_2"  "NIOZ132_mb_b260_2"  "NIOZ126_mb_b137_2" 
[28] "NIOZ129_mb_b254_2"  "NIOZ127_mb_b282_2"  "NIOZ122_mb_b305_2" 
[31] "NIOZ136_mb_b335_2"  "NIOZ132_mb_b198_2"  "NIOZ136_mb_b104_2" 
[34] "NIOZ125_mb_b178_2"  "NIOZ121_mb_b48_2"   "NIOZ134_cc_b149_2" 
[37] "NIOZ134_mb_b361_2"  "NIOZ136_mb_b226_2"  "NIOZ123_bs_b392_2" 
[40] "NIOZ124_mb_b130_2"  "NIOZ132_cc_b149_2"  "NIOZ125_cc_b75_2"  
[43] "NIOZ132_mx_b314_2"  "NIOZ120_mb_b229_2"  "NIOZ126_mb_b304_2" 
[46] "NIOZ119_mb_b5_2"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make cluster order</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>Cluster_order <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unique</span>(design_2<span class="sc">$</span>ClusterName))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>Cluster_order</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Basal (2)"   "Aquifer (4)" "Marine (6)"  "Clade1 (11)" "Clade2 (23)"</code></pre>
</div>
</div>
</section>
<section id="deal-with-mapping-files-for-the-annotations" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="deal-with-mapping-files-for-the-annotations"><span class="header-section-number">7.5</span> Deal with mapping files for the annotations</h2>
<p>The mapping files (Arcog_mapping and Metabolism_file_KEGG) that are provided with this tutorial give extra information and order our KO and arCOG annotations. Genes_of_interest is a list of key metabolic genes we want to look at more closely.</p>
<section id="load-and-view-the-tables" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="load-and-view-the-tables"><span class="header-section-number">7.5.1</span> Load and view the tables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#general mapping file for arcog IDs</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>Arcog_mapping <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"../data/ar14_arCOGdef19.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header=</span>T, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">""</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Arcog_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["arcog"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Pathway"],"name":[2],"type":["chr"],"align":["left"]},{"label":["GeneID"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Gene"],"name":[4],"type":["chr"],"align":["left"]},{"label":["COG"],"name":[5],"type":["chr"],"align":["left"]},{"label":["PFAM"],"name":[6],"type":["chr"],"align":["left"]},{"label":["CD"],"name":[7],"type":["chr"],"align":["left"]},{"label":["TIGR"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"arCOG00001","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"","_rn_":"1"},{"1":"arCOG00002","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"TIGR03433","_rn_":"2"},{"1":"arCOG00004","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"","_rn_":"3"},{"1":"arCOG00005","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"","_rn_":"4"},{"1":"arCOG00006","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"","_rn_":"5"},{"1":"arCOG00007","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"","7":"","8":"","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pathway mapping file</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>Metabolism_file_KEGG <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"../data/Metabolism_Table_KO_Apr2020.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header=</span>T, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">""</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Metabolism_file_KEGG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["IDs"],"name":[1],"type":["chr"],"align":["left"]},{"label":["KO"],"name":[2],"type":["chr"],"align":["left"]},{"label":["pathway_A"],"name":[3],"type":["chr"],"align":["left"]},{"label":["order"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Gene"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Comment.Uniprot.comment"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"ID1","2":"","3":"Nitrogen","4":"","5":"","6":"","_rn_":"1"},{"1":"ID2","2":"K02567","3":"Nitrogen","4":"N1","5":"napA; periplasmic nitrate reductase NapA [EC:1.7.99.4]","6":"Dissimilatory","_rn_":"2"},{"1":"ID3","2":"TIGR01706","3":"Nitrogen","4":"N1","5":"\"napA,  periplasmic nitrate reductase\"","6":"Dissimilatory","_rn_":"3"},{"1":"ID4","2":"K02573","3":"no_pathway","4":"","5":"napG; ferredoxin-type protein NapG","6":"","_rn_":"4"},{"1":"ID5","2":"K02574","3":"no_pathway","4":"","5":"","6":"","_rn_":"5"},{"1":"ID6","2":"K00367","3":"Nitrogen","4":"N1","5":"narB; ferredoxin-nitrate reductase [EC:1.7.7.2]","6":"Assimilatory","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load the genes of interest</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>Genes_of_interest <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"../data/Genes_of_interest.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header=</span>T, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">""</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Arcog_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["arcog"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Pathway"],"name":[2],"type":["chr"],"align":["left"]},{"label":["GeneID"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Gene"],"name":[4],"type":["chr"],"align":["left"]},{"label":["COG"],"name":[5],"type":["chr"],"align":["left"]},{"label":["PFAM"],"name":[6],"type":["chr"],"align":["left"]},{"label":["CD"],"name":[7],"type":["chr"],"align":["left"]},{"label":["TIGR"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"arCOG00001","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"","_rn_":"1"},{"1":"arCOG00002","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"TIGR03433","_rn_":"2"},{"1":"arCOG00004","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"","_rn_":"3"},{"1":"arCOG00005","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"","_rn_":"4"},{"1":"arCOG00006","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"pfam03551","7":"","8":"","_rn_":"5"},{"1":"arCOG00007","2":"K","3":"-","4":"\"Transcriptional regulator, PadR family\"","5":"COG01695","6":"","7":"","8":"","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="make-a-vector-to-order-our-genes-of-interest" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="make-a-vector-to-order-our-genes-of-interest"><span class="header-section-number">7.5.2</span> Make a vector to order our genes of interest</h3>
<ul>
<li>We use <code>unique()</code> to remove any duplicate gene names</li>
<li><code>arrange()</code> can be used to order our dataframe by more than one column.</li>
</ul>
<p>You notice here that the syntax for <code>arrange()</code> is a bit unusual and we use the <code>%&gt;%</code> symbol (a so-called forward pipe operator). This symbol is commonly used in the <strong>dplyr</strong> and <strong>tidyr</strong> packages which are extremely useful to summarize data. This function passes the left hand side of the operator to the first argument of the right hand side of the operator. In the following example, the data frame Genes_of_interest gets passed to <code>arrange()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#order metabolic genes</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>Genes_Metabolism_order_temp <span class="ot">&lt;-</span> Genes_of_interest <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Order, Order2)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#make a unique vector for our genes of interest</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>Genes_Metabolism_order <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unique</span>(Genes_Metabolism_order_temp<span class="sc">$</span>Gene))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>Genes_Metabolism_order</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "HmgB"                     "HmgA"                    
  [3] "MvK"                      "M3k"                     
  [5] "M3P5K"                    "mvaD"                    
  [7] "Ipk"                      "GFPS"                    
  [9] "EgsA"                     "GGGP_synthase"           
 [11] "UbiA"                     "GGR"                     
 [13] "CarS"                     "PgsA"                    
 [15] "ASS"                      "Asd"                     
 [17] "Pol-B1"                   "Pol-B2"                  
 [19] "Pol-B3"                   "PolB-casposon-associated"
 [21] "PolD_small"               "PolD_large"              
 [23] "Pol4"                     "PolX"                    
 [25] "Orc1"                     "SSB/RPA1"                
 [27] "RPA2"                     "RPA3"                    
 [29] "GinS"                     "PriS"                    
 [31] "PriL"                     "DnaG"                    
 [33] "Lig "                     "LigN"                    
 [35] "Pcn1"                     "RfcS"                    
 [37] "RfcL"                     "FEN1"                    
 [39] "RnhA"                     "RnhB"                    
 [41] "MCM2"                     "MPH1"                    
 [43] "BRR2"                     "MUS81"                   
 [45] "SrmB"                     "Dna2"                    
 [47] "TopA"                     "GyrA"                    
 [49] "GyrB"                     "Rgy"                     
 [51] "TopB"                     "Top6A"                   
 [53] "Top6B"                    "RecJ/Cdc45"              
 [55] "SbcC"                     "SbcD"                    
 [57] "NurA"                     "Nth"                     
 [59] "Nfo"                      "Nfi"                     
 [61] "NucS"                     "XthA"                    
 [63] "DinG"                     "SSO0112"                 
 [65] "HerA"                     "RadA"                    
 [67] "RadB"                     "Udg1 "                   
 [69] "AlkD"                     "Ogt"                     
 [71] "Ogg"                      "hjc"                     
 [73] "UvrA"                     "UvrB"                    
 [75] "UvrC"                     "MthTI"                   
 [77] "MthZI"                    "MjaII"                   
 [79] "MjaIII"                   "MjaV"                    
 [81] "Dcm"                      "DNA_met"                 
 [83] "HmfAB"                    "HmvA"                    
 [85] "ScpA"                     "ScpB"                    
 [87] "MC1"                      "Smc"                     
 [89] "Alba1"                    "ELP3"                    
 [91] "FtsZ"                     "MinD"                    
 [93] "Cren-1"                   "actin_like"              
 [95] "Rkd1"                     "Rkd2"                    
 [97] "CetZ1"                    "CdvA"                    
 [99] "CdvB"                     "Vps4"                    
[101] "RpoC/Rpo3"                "RpoC/Rpo11"              
[103] "RpoB/Rpo2"                "RpoA/Rpo1"               
[105] "Rpo6/RpoZ"                "RPB11"                   
[107] "Rpo4"                     "RPB5"                    
[109] "RPB7"                     "RPB8"                    
[111] "RPB10"                    "RPC12"                   
[113] "Rpo13"                    "TBP"                     
[115] "TFB"                      "TFE"                     
[117] "TFS"                      "LysM"                    
[119] "Spt4"                     "NusG"                    
[121] "NusA"                     "EGD2"                    
[123] "L1"                       "L2"                      
[125] "L3"                       "L4"                      
[127] "L5"                       "L6P"                     
[129] "L7AE"                     "L10"                     
[131] "L10AE/L16"                "L11"                     
[133] "L12E/L44/L45/RPP1/RPP2"   "L13"                     
[135] "L13E"                     "L14"                     
[137] "L14E/L6E/L27E"            "L15"                     
[139] "L15E"                     "L18"                     
[141] "L18E"                     "L19E"                    
[143] "L20A"                     "L21E"                    
[145] "L22"                      "L23"                     
[147] "L24"                      "L24E"                    
[149] "L29"                      "L30"                     
[151] "L30E"                     "L31E"                    
[153] "L32E"                     "L34E"                    
[155] "L35AE/L33A"               "L37AE/L43A"              
[157] "L37E"                     "L38E"                    
[159] "L39E"                     "L40E"                    
[161] "L41E"                     "L44E"                    
[163] "S2"                       "S3"                      
[165] "S3AE"                     "S4"                      
[167] "S4E"                      "S5"                      
[169] "S6E/S10"                  "S7"                      
[171] "S8"                       "S8E"                     
[173] "S9"                       "S10"                     
[175] "S11"                      "S12"                     
[177] "S13"                      "S14"                     
[179] "S15P"                     "S17"                     
[181] "S17E"                     "S19"                     
[183] "S19E"                     "S24E"                    
[185] "S25"                      "S26"                     
[187] "S27AE"                    "S27E"                    
[189] "S28E/S33"                 "S30"                     
[191] "PelA"                     "RsgA"                    
[193] "HflX"                     "AlaS"                    
[195] "ArgS"                     "AsnS"                    
[197] "CysS"                     "GlnS"                    
[199] "GRS1"                     "HisS"                    
[201] "IleS"                     "LeuS"                    
[203] "LysS"                     "LysU"                    
[205] "MetG"                     "PheS"                    
[207] "SerS"                     "ProS"                    
[209] "ThrS"                     "TrpS"                    
[211] "TyrS"                     "ValS"                    
[213] "EIF1A"                    "InfB"                    
[215] "SUI1"                     "EIF2A"                   
[217] "EIF2B "                   "EIF2B-like"              
[219] "EIF2G"                    "EIF4A"                   
[221] "EIF5a"                    "EIF6"                    
[223] "Tuf"                      "EFB1"                    
[225] "FusA"                     "eRF1"                    
[227] "Rli1"                     "Csl4"                    
[229] "Rrp4"                     "Rrp41"                   
[231] "Rrp42"                    "Dph2"                    
[233] "Dph5"                     "Dph6"                    
[235] "Trm5"                     "TYW1"                    
[237] "TYW2"                     "TYW3"                    
[239] "EndA"                     "Fau1"                    
[241] "LigT"                     "Nob1"                    
[243] "RtcB"                     "Archaease"               
[245] "RCL1"                     "RnjA"                    
[247] "Rnz"                      "Rnp1"                    
[249] "Rnp2"                     "Rnp3"                    
[251] "Rnp4"                     "TgtA"                    
[253] "DnaJ"                     "DnaK"                    
[255] "GrpE"                     "GroL"                    
[257] "HtpX"                     "Hsp16"                   
[259] "Hsp19"                    "PsmA"                    
[261] "PRE1"                     "Pan1"                    
[263] "Pcm"                      "ThsA"                    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define a order for metabolic pathways</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>Pathway_order <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unique</span>(Genes_of_interest<span class="sc">$</span>pathway_2))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>Pathway_order</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DNA_Polymerase"       "RFs"                  "Helicase"            
 [4] "Topoisomerase"        "Repair_Recombination" "Methylase"           
 [7] "Chromatin"            "Cell_cycle"           "RNA_Polymerase"      
[10] "TFs"                  "Transcription"        "Ribosome"            
[13] "tRNA_synthetase"      "Exosome"              "Diphthamide_BS"      
[16] "Wybutosine_BS"        "Translation"          "Posttranslation"     
[19] "Mevalonate"           "Lipids"              </code></pre>
</div>
</div>
</section>
</section>
<section id="deal-with-annotation-file" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="deal-with-annotation-file"><span class="header-section-number">7.6</span> Deal with annotation file</h2>
<section id="read-in-table" class="level3" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="read-in-table"><span class="header-section-number">7.6.1</span> Read in table</h3>
<p>You already here notice that this takes a bit longer and we just work with 46 bins. This is a good reason to keep python in mind as depending on your computer the more memory heavy operations might get challenging. Another alternative would be to run R on the clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read in data and view it</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Input <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"../data/UAP2_Annotation_table_u.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header=</span>T, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">""</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["accession"],"name":[1],"type":["chr"],"align":["left"]},{"label":["BinID"],"name":[2],"type":["chr"],"align":["left"]},{"label":["TaxString"],"name":[3],"type":["chr"],"align":["left"]},{"label":["NewContigID"],"name":[4],"type":["chr"],"align":["left"]},{"label":["OldContigId"],"name":[5],"type":["chr"],"align":["left"]},{"label":["ContigIdMerge"],"name":[6],"type":["chr"],"align":["left"]},{"label":["ContigNewLength"],"name":[7],"type":["int"],"align":["right"]},{"label":["GC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["ProteinID"],"name":[9],"type":["chr"],"align":["left"]},{"label":["ProteinGC"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["ProteinLength"],"name":[11],"type":["int"],"align":["right"]},{"label":["Prokka"],"name":[12],"type":["chr"],"align":["left"]},{"label":["arcogs"],"name":[13],"type":["chr"],"align":["left"]},{"label":["arcogs_geneID"],"name":[14],"type":["chr"],"align":["left"]},{"label":["arcogs_Description"],"name":[15],"type":["chr"],"align":["left"]},{"label":["Pathway"],"name":[16],"type":["chr"],"align":["left"]},{"label":["arcogs_evalue"],"name":[17],"type":["chr"],"align":["left"]},{"label":["KO_hmm"],"name":[18],"type":["chr"],"align":["left"]},{"label":["e_value"],"name":[19],"type":["chr"],"align":["left"]},{"label":["bit_score"],"name":[20],"type":["chr"],"align":["left"]},{"label":["bit_score_cutoff"],"name":[21],"type":["chr"],"align":["left"]},{"label":["Definition"],"name":[22],"type":["chr"],"align":["left"]},{"label":["confidence"],"name":[23],"type":["chr"],"align":["left"]},{"label":["PFAM_hmm"],"name":[24],"type":["chr"],"align":["left"]},{"label":["PFAM_description"],"name":[25],"type":["chr"],"align":["left"]},{"label":["Pfam_Evalue"],"name":[26],"type":["chr"],"align":["left"]},{"label":["TIRGR"],"name":[27],"type":["chr"],"align":["left"]},{"label":["TIGR_description"],"name":[28],"type":["chr"],"align":["left"]},{"label":["EC"],"name":[29],"type":["chr"],"align":["left"]},{"label":["TIGR_Evalue"],"name":[30],"type":["chr"],"align":["left"]},{"label":["CAZy"],"name":[31],"type":["chr"],"align":["left"]},{"label":["CAZy_evalue"],"name":[32],"type":["chr"],"align":["left"]},{"label":["Description"],"name":[33],"type":["chr"],"align":["left"]},{"label":["TDBD_ID"],"name":[34],"type":["chr"],"align":["left"]},{"label":["TPDB_evalue"],"name":[35],"type":["chr"],"align":["left"]},{"label":["HydDB"],"name":[36],"type":["chr"],"align":["left"]},{"label":["Description.1"],"name":[37],"type":["chr"],"align":["left"]},{"label":["HydDB_evalue"],"name":[38],"type":["chr"],"align":["left"]},{"label":["PFAM"],"name":[39],"type":["chr"],"align":["left"]},{"label":["PFAMdescription"],"name":[40],"type":["chr"],"align":["left"]},{"label":["IPR"],"name":[41],"type":["chr"],"align":["left"]},{"label":["IPRdescription"],"name":[42],"type":["chr"],"align":["left"]},{"label":["TopHit"],"name":[43],"type":["chr"],"align":["left"]},{"label":["E_value"],"name":[44],"type":["chr"],"align":["left"]},{"label":["PecID"],"name":[45],"type":["chr"],"align":["left"]},{"label":["TaxID"],"name":[46],"type":["chr"],"align":["left"]},{"label":["TaxString.1"],"name":[47],"type":["chr"],"align":["left"]}],"data":[{"1":"NIOZ119_mb_b5_2-PJFDGLDN_00010","2":"NIOZ119_mb_b5_2","3":"UAP2","4":"PJFDGLDN_1","5":"NIOZ119_sc1610046_1","6":"NIOZ119_mb_b5_2_contig_1","7":"2539","8":"0.432","9":"PJFDGLDN_00010","10":"0.094","11":"350","12":"Digeranylgeranylglycerophospholipid reductase","13":"arCOG00570","14":"-","15":"\"Geranylgeranyl_reductase,_flavoprotein\"","16":"I","17":"2.80E-75","18":"K17830","19":"2.10E-69","20":"243.3","21":"246.87","22":"digeranylgeranylglycerophospholipid_reductase_[EC:1.3.1.101_1.3.7.11]","23":"-","24":"PF01494","25":"FAD_binding_domain","26":"5.90E-09","27":"TIGR02032","28":"geranylgeranyl_reductase_family","29":"1.3.1.-","30":"1.40E-49","31":"-","32":"-","33":"-","34":"-","35":"-","36":"-","37":"-","38":"-","39":"IPR036188;_IPR002938","40":"FAD/NAD(P)-binding_domain_superfamily;_FAD-binding_domain","41":"PF01494","42":"FAD_binding_domain","43":"KYK22416.1_hypothetical_protein_AYK24_02275_[Thermoplasmatales_archaeon_SG8-52-4]","44":"2.80E-58","45":"36.5","46":"1803819","47":"\"Archaea,Euryarchaeota,Thermoplasmata,Thermoplasmatales,none,none,Thermoplasmatales_archaeon_SG8-52-4\"","_rn_":"1"},{"1":"NIOZ119_mb_b5_2-PJFDGLDN_00020","2":"NIOZ119_mb_b5_2","3":"UAP2","4":"PJFDGLDN_1","5":"NIOZ119_sc1610046_1","6":"NIOZ119_mb_b5_2_contig_1","7":"2539","8":"0.432","9":"PJFDGLDN_00020","10":"0.057","11":"105","12":"hypothetical protein","13":"-","14":"-","15":"-","16":"-","17":"-","18":"-","19":"-","20":"-","21":"-","22":"-","23":"-","24":"-","25":"-","26":"-","27":"-","28":"-","29":"-","30":"-","31":"-","32":"-","33":"-","34":"-","35":"-","36":"-","37":"-","38":"-","39":"-","40":"-","41":"-","42":"-","43":"-","44":"-","45":"-","46":"-","47":"-","_rn_":"2"},{"1":"NIOZ119_mb_b5_2-PJFDGLDN_00030","2":"NIOZ119_mb_b5_2","3":"UAP2","4":"PJFDGLDN_1","5":"NIOZ119_sc1610046_1","6":"NIOZ119_mb_b5_2_contig_1","7":"2539","8":"0.432","9":"PJFDGLDN_00030","10":"0.092","11":"304","12":"tRNA-2-methylthio-N(6)-dimethylallyladenosine synthase","13":"arCOG01358","14":"MiaB","15":"2-methylthioadenine_synthetase","16":"J","17":"5.80E-90","18":"K15865","19":"1.20E-109","20":"375.8","21":"343.7","22":"threonylcarbamoyladenosine_tRNA_methylthiotransferase_CDKAL1_[EC:2.8.4.5]","23":"high_score","24":"PF04055","25":"Radical_SAM_superfamily","26":"2.60E-21","27":"TIGR01578","28":"\"MiaB-like_tRNA_modifying_enzyme,_archaeal-type\"","29":"-","30":"1.70E-104","31":"-","32":"-","33":"-","34":"-","35":"-","36":"-","37":"-","38":"-","39":"IPR005839;_IPR002792;_IPR006466;_IPR006638;_IPR007197;_IPR020612;_IPR023404","40":"\"Methylthiotransferase;_TRAM_domain;_MiaB-like_tRNA_modifying_enzyme,_archaeal-type;_Elp3/MiaB/NifB;_Radical_SAM;_Methylthiotransferase,_conserved_site;_Radical_SAM,_alpha/beta_horseshoe\"","41":"PF01938;_PF04055","42":"TRAM_domain;_Radical_SAM_superfamily","43":"OIO63284.1_hypothetical_protein_AUJ83_01460_[Candidatus_Woesearchaeota_archaeon_CG1_02_33_12]","44":"8.20E-91","45":"55.6","46":"1805422","47":"\"Archaea,Candidatus_Woesearchaeota,none,none,none,none,Candidatus_Woesearchaeota_archaeon_CG1_02_33_12\"","_rn_":"3"},{"1":"NIOZ119_mb_b5_2-PJFDGLDN_00040","2":"NIOZ119_mb_b5_2","3":"UAP2","4":"PJFDGLDN_2","5":"NIOZ119_sc560284_1","6":"NIOZ119_mb_b5_2_contig_2","7":"4191","8":"0.456","9":"PJFDGLDN_00040","10":"0.065","11":"92","12":"Enolase","13":"arCOG01169","14":"Eno","15":"Enolase","16":"G","17":"4.00E-26","18":"K01689","19":"5.10E-20","20":"81","21":"48.73","22":"enolase_[EC:4.2.1.11]","23":"high_score","24":"PF00113","25":"\"Enolase,_C-terminal_TIM_barrel_domain\"","26":"1.20E-20","27":"TIGR01060","28":"phosphopyruvate_hydratase","29":"4.2.1.11","30":"1.10E-25","31":"-","32":"-","33":"-","34":"-","35":"-","36":"-","37":"-","38":"-","39":"IPR020810;_IPR036849;_IPR000941;_IPR020809","40":"\"Enolase,_C-terminal_TIM_barrel_domain;_Enolase-like,_C-terminal_domain_superfamily;_Enolase;_Enolase,_conserved_site\"","41":"PF00113","42":"\"Enolase,_C-terminal_TIM_barrel_domain\"","43":"BAW30993.1_2-phosphoglycerate_dehydratase_[Methanothermobacter_sp._MT-2]","44":"3.80E-23","45":"70.7","46":"1898379","47":"\"Archaea,Euryarchaeota,Methanobacteria,Methanobacteriales,Methanobacteriaceae,Methanothermobacter,Methanothermobacter_sp._MT-2\"","_rn_":"4"},{"1":"NIOZ119_mb_b5_2-PJFDGLDN_00050","2":"NIOZ119_mb_b5_2","3":"UAP2","4":"PJFDGLDN_2","5":"NIOZ119_sc560284_1","6":"NIOZ119_mb_b5_2_contig_2","7":"4191","8":"0.456","9":"PJFDGLDN_00050","10":"0.059","11":"218","12":"30S ribosomal protein S2","13":"arCOG04245","14":"RpsB","15":"Ribosomal_protein_S2","16":"J","17":"8.90E-64","18":"K02998","19":"1.60E-46","20":"167.8","21":"210.97","22":"small_subunit_ribosomal_protein_SAe","23":"-","24":"PF00318","25":"Ribosomal_protein_S2","26":"7.00E-24","27":"TIGR01012","28":"ribosomal_protein_uS2","29":"-","30":"1.00E-72","31":"-","32":"-","33":"-","34":"-","35":"-","36":"-","37":"-","38":"-","39":"IPR005707;_IPR023454;_IPR023591;_IPR018130;_IPR001865","40":"\"Ribosomal_protein_S2,_eukaryotic/archaeal;_Ribosomal_protein_S2,_archaeal;_Ribosomal_protein_S2,_flavodoxin-like_domain_superfamily;_Ribosomal_protein_S2,_conserved_site;_Ribosomal_protein_S2\"","41":"PF00318","42":"Ribosomal_protein_S2","43":"A0B6E5.1_RecName:_Full=30S_ribosomal_protein_S2","44":"1.20E-56","45":"52.8","46":"349307","47":"\"Archaea,Euryarchaeota,Methanomicrobia,Methanosarcinales,Methanotrichaceae,Methanothrix,Methanothrix_thermoacetophila\"","_rn_":"5"},{"1":"NIOZ119_mb_b5_2-PJFDGLDN_00060","2":"NIOZ119_mb_b5_2","3":"UAP2","4":"PJFDGLDN_2","5":"NIOZ119_sc560284_1","6":"NIOZ119_mb_b5_2_contig_2","7":"4191","8":"0.456","9":"PJFDGLDN_00060","10":"0.100","11":"280","12":"hypothetical protein","13":"arCOG01728","14":"Mho1","15":"\"Predicted_class_III_extradiol_dioxygenase,_MEMO1_family\"","16":"R","17":"8.80E-74","18":"K06990","19":"1.40E-72","20":"253.3","21":"47","22":"MEMO1_family_protein","23":"high_score","24":"PF01875","25":"Memo-like_protein","26":"4.50E-77","27":"TIGR04336","28":"AmmeMemoRadiSam_system_protein_B","29":"-","30":"5.30E-91","31":"-","32":"-","33":"-","34":"-","35":"-","36":"-","37":"-","38":"-","39":"IPR002737","40":"MEMO1_family","41":"PF01875","42":"Memo-like_protein","43":"OYT50994.1_AmmeMemoRadiSam_system_protein_B_[Candidatus_Bathyarchaeota_archaeon_ex4484_135]","44":"1.30E-66","45":"47","46":"2012509","47":"\"Archaea,Candidatus_Bathyarchaeota,none,none,none,none,Candidatus_Bathyarchaeota_archaeon_ex4484_135\"","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="make-a-mapping-file-that-links-all-annotation-ids-to-their-descriptions" class="level3" data-number="7.6.2">
<h3 data-number="7.6.2" class="anchored" data-anchor-id="make-a-mapping-file-that-links-all-annotation-ids-to-their-descriptions"><span class="header-section-number">7.6.2</span> Make a mapping file that links all annotation IDs to their descriptions</h3>
<p>What we do:</p>
<ul>
<li>separate columns we are interested in for each Database of interest, i.e.&nbsp;arCOGs, and remove duplicate rows by using <code>unique()</code></li>
<li>change the column names using <code>colnames()</code>. Here, we want to make sure that all the 6 new objects we generate have the same columns</li>
<li>combine our 6 dataframes using <code>rbind()</code>. For this to work we need the same number of columns.</li>
</ul>
<p>In theory that would be a nice example for a loop as well, since we do exactly the same thing for 6x.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#generate Description table for all DBs of interest</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>Arcogs_Description <span class="ot">&lt;-</span> <span class="fu">unique</span>(Input[,<span class="fu">c</span>(<span class="st">"arcogs"</span>,<span class="st">"arcogs_Description"</span> )])</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Arcogs_Description) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gene"</span>, <span class="st">"Description"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Arcogs_Description)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">arCOG00570</td>
<td style="text-align: left;">“Geranylgeranyl_reductase,_flavoprotein”</td>
</tr>
<tr class="even">
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arCOG01358</td>
<td style="text-align: left;">2-methylthioadenine_synthetase</td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG01169</td>
<td style="text-align: left;">Enolase</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arCOG04245</td>
<td style="text-align: left;">Ribosomal_protein_S2</td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG01728</td>
<td style="text-align: left;">“Predicted_class_III_extradiol_dioxygenase,_MEMO1_family”</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>KOs_Description <span class="ot">&lt;-</span> Input[,<span class="fu">c</span>(<span class="st">"KO_hmm"</span>,<span class="st">"Definition"</span> )]</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(KOs_Description) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gene"</span>, <span class="st">"Description"</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(KOs_Description)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">K17830</td>
<td style="text-align: left;">digeranylgeranylglycerophospholipid_reductase_[EC:1.3.1.101_1.3.7.11]</td>
</tr>
<tr class="even">
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">K15865</td>
<td style="text-align: left;">threonylcarbamoyladenosine_tRNA_methylthiotransferase_CDKAL1_[EC:2.8.4.5]</td>
</tr>
<tr class="even">
<td style="text-align: left;">K01689</td>
<td style="text-align: left;">enolase_[EC:4.2.1.11]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">K02998</td>
<td style="text-align: left;">small_subunit_ribosomal_protein_SAe</td>
</tr>
<tr class="even">
<td style="text-align: left;">K06990</td>
<td style="text-align: left;">MEMO1_family_protein</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>Pfam_Description <span class="ot">&lt;-</span> <span class="fu">unique</span>(Input[,<span class="fu">c</span>(<span class="st">"PFAM_hmm"</span>,<span class="st">"PFAM_description"</span> )])</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Pfam_Description) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gene"</span>, <span class="st">"Description"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Pfam_Description)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PF01494</td>
<td style="text-align: left;">FAD_binding_domain</td>
</tr>
<tr class="even">
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF04055</td>
<td style="text-align: left;">Radical_SAM_superfamily</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF00113</td>
<td style="text-align: left;">“Enolase,_C-terminal_TIM_barrel_domain”</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF00318</td>
<td style="text-align: left;">Ribosomal_protein_S2</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF01875</td>
<td style="text-align: left;">Memo-like_protein</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>TIRGR_Description <span class="ot">&lt;-</span> <span class="fu">unique</span>(Input[,<span class="fu">c</span>(<span class="st">"TIRGR"</span>,<span class="st">"TIGR_description"</span> )])</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(TIRGR_Description) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gene"</span>, <span class="st">"Description"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(TIRGR_Description)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TIGR02032</td>
<td style="text-align: left;">geranylgeranyl_reductase_family</td>
</tr>
<tr class="even">
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TIGR01578</td>
<td style="text-align: left;">“MiaB-like_tRNA_modifying_enzyme,_archaeal-type”</td>
</tr>
<tr class="even">
<td style="text-align: left;">TIGR01060</td>
<td style="text-align: left;">phosphopyruvate_hydratase</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TIGR01012</td>
<td style="text-align: left;">ribosomal_protein_uS2</td>
</tr>
<tr class="even">
<td style="text-align: left;">TIGR04336</td>
<td style="text-align: left;">AmmeMemoRadiSam_system_protein_B</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>Cazy_Description <span class="ot">&lt;-</span> <span class="fu">unique</span>(Input[,<span class="fu">c</span>(<span class="st">"CAZy"</span>,<span class="st">"Description"</span> )])</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Cazy_Description) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gene"</span>, <span class="st">"Description"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Cazy_Description)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 98%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">81</td>
<td style="text-align: left;">GH119</td>
<td style="text-align: left;">__alpha-amylase_(EC_3.2.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">245</td>
<td style="text-align: left;">GT4</td>
<td style="text-align: left;">“__sucrose_synthase_(EC_2.4.1.13);<em>sucrose-phosphate_synthase</em>(EC_2.4.1.14);<em>alpha-glucosyltransferase</em>(EC_2.4.1.52);<em>lipopolysaccharide_N-acetylglucosaminyltransferase</em>(EC_2.4.1.56);<em>phosphatidylinositol_alpha-mannosyltransferase</em>(EC_2.4.1.57);_GDP-Man:<em>Man1GlcNAc2-PP-dolichol_alpha-1,3-mannosyltransferase</em>(EC_2.4.1.132);_GDP-Man:<em>Man3GlcNAc2-PP-dolichol/Man4GlcNAc2-PP-dolichol_alpha-1,2-mannosyltransferase</em>(EC_2.4.1.131);<em>digalactosyldiacylglycerol_synthase</em>(EC_2.4.1.141);<em>1,2-diacylglycerol_3-glucosyltransferase</em>(EC_2.4.1.157);__diglucosyl_diacylglycerol_synthase_(EC_2.4.1.208);<em>trehalose_phosphorylase</em>(EC_2.4.1.231);_NDP-Glc:<em>alpha-glucose_alpha-glucosyltransferase</em>/<em>alpha,alpha-trehalose_synthase</em>(EC_2.4.1.245);_GDP-Man:<em>Man2GlcNAc2-PP-dolichol_alpha-1,6-mannosyltransferase</em>(EC_2.4.1.257);_UDP-GlcNAc:<em>2-deoxystreptamine_alpha-N-acetylglucosaminyltransferase</em>(EC_2.4.1.283);_UDP-GlcNAc:<em>ribostamycin_alpha-N-acetylglucosaminyltransferase</em>(EC_2.4.1.285);<em>UDP-Gal_alpha-galactosyltransferase</em>(EC_2.4.1.-);<em>UDP-Xyl_alpha-xylosyltransferase</em>(EC_2.4.2.-);<em>UDP-GlcA_alpha-glucuronyltransferase</em>(EC_2.4.1.-);<em>UDP-Glc_alpha-glucosyltransferase</em>(EC_2.4.1.-);_UDP-GalNAc:<em>GalNAc-PP-Und_alpha-1,3-N-acetylgalactosaminyltransferase</em>(EC_2.4.1.306);_UDP-GalNAc:<em>N,N’-diacetylbacillosaminyl-PP-Und_alpha-1,3-N-acetylgalactosaminyltransferase</em>(EC_2.4.1.290);<em>ADP-dependent_alpha-maltose-1-phosphate_synthase</em>(2.4.1.342)”</td>
</tr>
<tr class="even">
<td style="text-align: left;">291</td>
<td style="text-align: left;">GT2_Glycos_transf_2</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">613</td>
<td style="text-align: left;">GT83</td>
<td style="text-align: left;">__undecaprenyl_phosphate-alpha-L-Ara4N:<em>4-amino-4-deoxy-beta-L-arabinosyltransferase</em>(EC_2.4.2.43);_dodecaprenyl_phosphate-beta-galacturonic_acid:<em>lipopolysaccharide_core_alpha-galacturonosyl_transferase</em>(EC_2.4.1.-)</td>
</tr>
<tr class="even">
<td style="text-align: left;">1357</td>
<td style="text-align: left;">GT66</td>
<td style="text-align: left;">__dolichyl-diphosphooligosaccharide<c3>&lt;83&gt;<c2><a2><c3><a2><e2>&lt;80&gt;&lt;9a&gt;<c2><ac><c3><a2><e2>&lt;82&gt;<ac><c2>&lt;9d&gt;protein_glycotransferase_(EC_2.4.99.18);<em>undecaprenyl-diphosphooligosaccharide<c3>&lt;83&gt;<c2><a2><c3><a2><e2>&lt;80&gt;&lt;9a&gt;<c2><ac><c3><a2><e2>&lt;82&gt;<ac><c2>&lt;9d&gt;protein_glycotransferase</c2></ac></e2></a2></c3></ac></c2></e2></a2></c3></a2></c2></c3></em>(EC_2.4.99.19)_</c2></ac></e2></a2></c3></ac></c2></e2></a2></c3></a2></c2></c3></td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>HydDB_Description <span class="ot">&lt;-</span> <span class="fu">unique</span>(Input[,<span class="fu">c</span>(<span class="st">"Description.1"</span>,<span class="st">"Description.1"</span> )])</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HydDB_Description) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gene"</span>, <span class="st">"Description"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(HydDB_Description)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">4787</td>
<td style="text-align: left;">[FeFe]_Group_A1</td>
<td style="text-align: left;">[FeFe]_Group_A1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18935</td>
<td style="text-align: left;">[NiFe]_Group_4g</td>
<td style="text-align: left;">[NiFe]_Group_4g</td>
</tr>
<tr class="even">
<td style="text-align: left;">19355</td>
<td style="text-align: left;">[NiFe]_Group_3b</td>
<td style="text-align: left;">[NiFe]_Group_3b</td>
</tr>
<tr class="odd">
<td style="text-align: left;">37081</td>
<td style="text-align: left;">[FeFe]_Group_C3</td>
<td style="text-align: left;">[FeFe]_Group_C3</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make a file with a description of all the ids for each search</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>All_Genes_Description <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Arcogs_Description,KOs_Description,Pfam_Description,TIRGR_Description, Cazy_Description, HydDB_Description)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="parse-table-to-make-it-easier-to-work-with-it" class="level3" data-number="7.6.3">
<h3 data-number="7.6.3" class="anchored" data-anchor-id="parse-table-to-make-it-easier-to-work-with-it"><span class="header-section-number">7.6.3</span> Parse table to make it easier to work with it</h3>
<p>Here we:</p>
<ul>
<li>Subset the data for the columns we are interested in. Esp. for larger dataframes this will make the operations a bit quicker. For very large dataframes, i.e.&nbsp;5000 genomes, it might be better to switch to python</li>
<li>Convert data from wide to long format</li>
<li>Clean factors. After subsetting often factors are not removed, we clean them up in that step</li>
</ul>
<p>Info:</p>
<p><strong>Converting a wide to a long dataframe</strong></p>
<ul>
<li>Wide dataframe: The Input data in this example is considered as a wide dataframe. I.e. all the gene IDs we are interested in are spread out into different columns</li>
<li>Long dataframe: The gene IDs we are interested in are found all in the same column. Important, most R functions work with long dataframes.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print the column names to subset our datatable</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "accession"          "BinID"              "TaxString"         
 [4] "NewContigID"        "OldContigId"        "ContigIdMerge"     
 [7] "ContigNewLength"    "GC"                 "ProteinID"         
[10] "ProteinGC"          "ProteinLength"      "Prokka"            
[13] "arcogs"             "arcogs_geneID"      "arcogs_Description"
[16] "Pathway"            "arcogs_evalue"      "KO_hmm"            
[19] "e_value"            "bit_score"          "bit_score_cutoff"  
[22] "Definition"         "confidence"         "PFAM_hmm"          
[25] "PFAM_description"   "Pfam_Evalue"        "TIRGR"             
[28] "TIGR_description"   "EC"                 "TIGR_Evalue"       
[31] "CAZy"               "CAZy_evalue"        "Description"       
[34] "TDBD_ID"            "TPDB_evalue"        "HydDB"             
[37] "Description.1"      "HydDB_evalue"       "PFAM"              
[40] "PFAMdescription"    "IPR"                "IPRdescription"    
[43] "TopHit"             "E_value"            "PecID"             
[46] "TaxID"              "TaxString.1"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#only keep the columns we actually want to work with</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>Input_subset <span class="ot">=</span> Input[,<span class="fu">c</span>(<span class="st">'BinID'</span>,<span class="st">'accession'</span>,<span class="st">'arcogs'</span>,<span class="st">'KO_hmm'</span>,<span class="st">'PFAM_hmm'</span>,<span class="st">'TIRGR'</span>,<span class="st">'CAZy'</span>,<span class="st">'Description.1'</span> )]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Input_subset)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 30%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">BinID</th>
<th style="text-align: left;">accession</th>
<th style="text-align: left;">arcogs</th>
<th style="text-align: left;">KO_hmm</th>
<th style="text-align: left;">PFAM_hmm</th>
<th style="text-align: left;">TIRGR</th>
<th style="text-align: left;">CAZy</th>
<th style="text-align: left;">Description.1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00010</td>
<td style="text-align: left;">arCOG00570</td>
<td style="text-align: left;">K17830</td>
<td style="text-align: left;">PF01494</td>
<td style="text-align: left;">TIGR02032</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00020</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00030</td>
<td style="text-align: left;">arCOG01358</td>
<td style="text-align: left;">K15865</td>
<td style="text-align: left;">PF04055</td>
<td style="text-align: left;">TIGR01578</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00040</td>
<td style="text-align: left;">arCOG01169</td>
<td style="text-align: left;">K01689</td>
<td style="text-align: left;">PF00113</td>
<td style="text-align: left;">TIGR01060</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00050</td>
<td style="text-align: left;">arCOG04245</td>
<td style="text-align: left;">K02998</td>
<td style="text-align: left;">PF00318</td>
<td style="text-align: left;">TIGR01012</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00060</td>
<td style="text-align: left;">arCOG01728</td>
<td style="text-align: left;">K06990</td>
<td style="text-align: left;">PF01875</td>
<td style="text-align: left;">TIGR04336</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert dataframe from wide to long</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>Input_long <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(Input_subset,  <span class="at">id=</span><span class="fu">c</span>(<span class="st">"accession"</span>,<span class="st">"BinID"</span>))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">#give informative headers</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Input_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"accession"</span>, <span class="st">"BinID"</span>, <span class="st">"DB"</span>, <span class="st">"gene"</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co">#clean factors, to remove issues when counting</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>Input_long<span class="sc">$</span>gene <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Input_long<span class="sc">$</span>gene)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Input_long)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">accession</th>
<th style="text-align: left;">BinID</th>
<th style="text-align: left;">DB</th>
<th style="text-align: left;">gene</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00010</td>
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">arcogs</td>
<td style="text-align: left;">arCOG00570</td>
</tr>
<tr class="even">
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00020</td>
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">arcogs</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00030</td>
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">arcogs</td>
<td style="text-align: left;">arCOG01358</td>
</tr>
<tr class="even">
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00040</td>
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">arcogs</td>
<td style="text-align: left;">arCOG01169</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00050</td>
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">arcogs</td>
<td style="text-align: left;">arCOG04245</td>
</tr>
<tr class="even">
<td style="text-align: left;">NIOZ119_mb_b5_2-PJFDGLDN_00060</td>
<td style="text-align: left;">NIOZ119_mb_b5_2</td>
<td style="text-align: left;">arcogs</td>
<td style="text-align: left;">arCOG01728</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="make-count-tables" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="make-count-tables"><span class="header-section-number">7.7</span> Make count tables</h2>
<section id="generate-a-count-table-for-our-genomes-of-interest" class="level3" data-number="7.7.1">
<h3 data-number="7.7.1" class="anchored" data-anchor-id="generate-a-count-table-for-our-genomes-of-interest"><span class="header-section-number">7.7.1</span> Generate a count table for our genomes of interest</h3>
<p>Now we want to count, how often does a genome (i.e.&nbsp;NIOZ134_mb_b41_2) have a gene. I.e. how often do we want arCOG00570, arCOG01358, …</p>
<section id="do-this-via-a-loop-not-executed-just-an-example" class="level5" data-number="7.7.1.0.1">
<h5 data-number="7.7.1.0.1" class="anchored" data-anchor-id="do-this-via-a-loop-not-executed-just-an-example"><span class="header-section-number">7.7.1.0.1</span> Do this via a loop (not executed, just an example)</h5>
<p>Notice:</p>
<p>Since we run this chunk with <code>, eval = FALSE</code> we can still see the code but it is not executed. This is done because some computations take some time, which we do not want to spend, but I still want to show the code to give some alternative examples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#count the number of proteins for each genome of interest</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> Bin_order) {</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span>  <span class="fu">table</span>(<span class="fu">subset</span>(Input_long, BinID <span class="sc">%in%</span> <span class="fu">paste</span>(i))<span class="sc">$</span>gene)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">cbind</span> (y,x)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co">#clean-up the table</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>Counts_Table_loop <span class="ot">&lt;-</span> y</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Counts_Table_loop) <span class="ot">&lt;-</span> Bin_order</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>Counts_Table_loop <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Counts_Table_loop)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_loop)), <span class="at">format=</span><span class="st">'markdown'</span>)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="co">#the '-' (=not identified genes) is also counted and listed in the first column and removed at this step</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>Counts_Table_loop <span class="ot">&lt;-</span> Counts_Table_loop[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_loop)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-this-via-ddply-not-executed-just-an-example" class="level5" data-number="7.7.1.0.2">
<h5 data-number="7.7.1.0.2" class="anchored" data-anchor-id="do-this-via-ddply-not-executed-just-an-example"><span class="header-section-number">7.7.1.0.2</span> Do this via ddply ((not executed, just an example))</h5>
<p>New functions:</p>
<ul>
<li><code>spread()</code> = converts our long to a wide dataframe by using the BinIDs as new column names, the count table as values to populate our dataframe and with missing values we print a 0.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#count data and clean header</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long <span class="ot">&lt;-</span> <span class="fu">ddply</span>(Input_long, .(BinID, gene), summarize, <span class="at">GeneCount =</span> <span class="fu">length</span>(gene))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Counts_Table_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BinID"</span>, <span class="st">"geneID"</span>, <span class="st">"count"</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long)), <span class="at">format=</span><span class="st">'markdown'</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#transform to wide format, with fill = 0 instead of a NA we add a 0</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>Counts_Table_wide <span class="ot">&lt;-</span> <span class="fu">spread</span>(Counts_Table_long, BinID, count, <span class="at">fill =</span> <span class="dv">0</span> )</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co">#view data</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_wide)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-this-via-tidyr-usually-a-bit-faster-than-ddplyr-which-is-why-we-use-this-way" class="level5" data-number="7.7.1.0.3">
<h5 data-number="7.7.1.0.3" class="anchored" data-anchor-id="do-this-via-tidyr-usually-a-bit-faster-than-ddplyr-which-is-why-we-use-this-way"><span class="header-section-number">7.7.1.0.3</span> Do this via tidyr (usually a bit faster than ddplyr, which is why we use this way)</h5>
<p>Here, we use the <code>%&gt;%</code> symbol again: In the following example, the a subset of the Input_long data (only 3 columns, not the whole dataframe) gets passed to <code>count()</code></p>
<p>New functions:</p>
<ul>
<li><code>count()</code> = A function of the dplyr package. Here, we count the unique protein IDs grouped by BinID and gene (i.e.&nbsp;roughly equivalent to the columns we want to keep)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#count data and clean header</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long <span class="ot">&lt;-</span> Input_long[,<span class="fu">c</span>(<span class="st">'accession'</span>, <span class="st">'BinID'</span>,<span class="st">'gene'</span>)] <span class="sc">%&gt;%</span> <span class="fu">count</span>(BinID, gene, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Counts_Table_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BinID"</span>, <span class="st">"geneID"</span>, <span class="st">"count"</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">BinID</th>
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">-</td>
<td style="text-align: right;">2350</td>
</tr>
<tr class="even">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT2_Glycos_transf_2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT66</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT83</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When viewing the data we also see that proteins with no annotations are counted (the minus symbol), since we do not care about this at this stage, lets remove everything with a minus symbol</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#delete rows with a minus symbol</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long <span class="ot">&lt;-</span> Counts_Table_long[Counts_Table_long<span class="sc">$</span>geneID<span class="sc">!=</span> <span class="st">"-"</span>, ]</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">#clean factors</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>Counts_Table_long<span class="sc">$</span>geneID <span class="ot">&lt;-</span> <span class="fu">factor</span>(Counts_Table_long<span class="sc">$</span>geneID)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">#view data</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">BinID</th>
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT2_Glycos_transf_2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT66</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT83</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">K00012</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, we can convert the long to a wide table, since this format is a bit easier to read in excel later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#transform to wide format, with fill = 0 instead of a NA we add a 0</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_wide <span class="ot">&lt;-</span> <span class="fu">spread</span>(Counts_Table_long, BinID, count, <span class="at">fill =</span> <span class="dv">0</span> )</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_wide)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 0%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">GCA_002494525</th>
<th style="text-align: right;">GCA_002495465</th>
<th style="text-align: right;">GCA_002501985</th>
<th style="text-align: right;">GCA_002502135</th>
<th style="text-align: right;">NIOZ119_mb_b5_2</th>
<th style="text-align: right;">NIOZ120_mb_b229_2</th>
<th style="text-align: right;">NIOZ121_cc_b94_2</th>
<th style="text-align: right;">NIOZ121_mb_b48_2</th>
<th style="text-align: right;">NIOZ122_mb_b305_2</th>
<th style="text-align: right;">NIOZ122_mb_b319_2</th>
<th style="text-align: right;">NIOZ123_bs_b392_2</th>
<th style="text-align: right;">NIOZ123_bs_b5_2</th>
<th style="text-align: right;">NIOZ124_cc_b247_2</th>
<th style="text-align: right;">NIOZ124_mb_b130_2</th>
<th style="text-align: right;">NIOZ125_cc_b75_2</th>
<th style="text-align: right;">NIOZ125_mb_b178_2</th>
<th style="text-align: right;">NIOZ125_mb_b254_2</th>
<th style="text-align: right;">NIOZ126_mb_b137_2</th>
<th style="text-align: right;">NIOZ126_mb_b304_2</th>
<th style="text-align: right;">NIOZ126_mb_b401_2</th>
<th style="text-align: right;">NIOZ127_mb_b161_2</th>
<th style="text-align: right;">NIOZ127_mb_b282_2</th>
<th style="text-align: right;">NIOZ129_mb_b254_2</th>
<th style="text-align: right;">NIOZ129_mb_b262_2</th>
<th style="text-align: right;">NIOZ132_cc_b149_2</th>
<th style="text-align: right;">NIOZ132_cc_b51_2</th>
<th style="text-align: right;">NIOZ132_mb_b198_2</th>
<th style="text-align: right;">NIOZ132_mb_b260_2</th>
<th style="text-align: right;">NIOZ132_mb_b282_2</th>
<th style="text-align: right;">NIOZ132_mx_b314_2</th>
<th style="text-align: right;">NIOZ134_cc_b149_2</th>
<th style="text-align: right;">NIOZ134_mb_b293_2</th>
<th style="text-align: right;">NIOZ134_mb_b361_2</th>
<th style="text-align: right;">NIOZ134_mb_b41_2</th>
<th style="text-align: right;">NIOZ134_mx_b281_2</th>
<th style="text-align: right;">NIOZ136_cc_b15_2</th>
<th style="text-align: right;">NIOZ136_mb_b104_2</th>
<th style="text-align: right;">NIOZ136_mb_b226_2</th>
<th style="text-align: right;">NIOZ136_mb_b335_2</th>
<th style="text-align: right;">SRR2090153_bin1042</th>
<th style="text-align: right;">SRR2090153_bin461</th>
<th style="text-align: right;">SRR2090159_bin1129</th>
<th style="text-align: right;">SRR2090159_bin1288</th>
<th style="text-align: right;">SRR4028224_bin17</th>
<th style="text-align: right;">SRR5007147_bin71</th>
<th style="text-align: right;">U_76725</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CBM44</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">CE4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH119</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH130</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH95</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Also, we want our geneIDs to be the new rownames and we do this by using the <code>rownames()</code> functions. We do this since some functions do not like to have characters in their dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#change the rownames</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Counts_Table_wide) <span class="ot">&lt;-</span> Counts_Table_wide<span class="sc">$</span>geneID</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co">#view data</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_wide)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 0%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">GCA_002494525</th>
<th style="text-align: right;">GCA_002495465</th>
<th style="text-align: right;">GCA_002501985</th>
<th style="text-align: right;">GCA_002502135</th>
<th style="text-align: right;">NIOZ119_mb_b5_2</th>
<th style="text-align: right;">NIOZ120_mb_b229_2</th>
<th style="text-align: right;">NIOZ121_cc_b94_2</th>
<th style="text-align: right;">NIOZ121_mb_b48_2</th>
<th style="text-align: right;">NIOZ122_mb_b305_2</th>
<th style="text-align: right;">NIOZ122_mb_b319_2</th>
<th style="text-align: right;">NIOZ123_bs_b392_2</th>
<th style="text-align: right;">NIOZ123_bs_b5_2</th>
<th style="text-align: right;">NIOZ124_cc_b247_2</th>
<th style="text-align: right;">NIOZ124_mb_b130_2</th>
<th style="text-align: right;">NIOZ125_cc_b75_2</th>
<th style="text-align: right;">NIOZ125_mb_b178_2</th>
<th style="text-align: right;">NIOZ125_mb_b254_2</th>
<th style="text-align: right;">NIOZ126_mb_b137_2</th>
<th style="text-align: right;">NIOZ126_mb_b304_2</th>
<th style="text-align: right;">NIOZ126_mb_b401_2</th>
<th style="text-align: right;">NIOZ127_mb_b161_2</th>
<th style="text-align: right;">NIOZ127_mb_b282_2</th>
<th style="text-align: right;">NIOZ129_mb_b254_2</th>
<th style="text-align: right;">NIOZ129_mb_b262_2</th>
<th style="text-align: right;">NIOZ132_cc_b149_2</th>
<th style="text-align: right;">NIOZ132_cc_b51_2</th>
<th style="text-align: right;">NIOZ132_mb_b198_2</th>
<th style="text-align: right;">NIOZ132_mb_b260_2</th>
<th style="text-align: right;">NIOZ132_mb_b282_2</th>
<th style="text-align: right;">NIOZ132_mx_b314_2</th>
<th style="text-align: right;">NIOZ134_cc_b149_2</th>
<th style="text-align: right;">NIOZ134_mb_b293_2</th>
<th style="text-align: right;">NIOZ134_mb_b361_2</th>
<th style="text-align: right;">NIOZ134_mb_b41_2</th>
<th style="text-align: right;">NIOZ134_mx_b281_2</th>
<th style="text-align: right;">NIOZ136_cc_b15_2</th>
<th style="text-align: right;">NIOZ136_mb_b104_2</th>
<th style="text-align: right;">NIOZ136_mb_b226_2</th>
<th style="text-align: right;">NIOZ136_mb_b335_2</th>
<th style="text-align: right;">SRR2090153_bin1042</th>
<th style="text-align: right;">SRR2090153_bin461</th>
<th style="text-align: right;">SRR2090159_bin1129</th>
<th style="text-align: right;">SRR2090159_bin1288</th>
<th style="text-align: right;">SRR4028224_bin17</th>
<th style="text-align: right;">SRR5007147_bin71</th>
<th style="text-align: right;">U_76725</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CBM44</td>
<td style="text-align: left;">CBM44</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">CE4</td>
<td style="text-align: left;">CE4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH119</td>
<td style="text-align: left;">GH119</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH130</td>
<td style="text-align: left;">GH130</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH95</td>
<td style="text-align: left;">GH95</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When we change the rownames and view the data, we see that the geneID is now both in the rownames as well as the first column. Since that is a bit messy, we next remove the first column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#delete the first column</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_wide <span class="ot">&lt;-</span> Counts_Table_wide[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_wide)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 0%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">GCA_002494525</th>
<th style="text-align: right;">GCA_002495465</th>
<th style="text-align: right;">GCA_002501985</th>
<th style="text-align: right;">GCA_002502135</th>
<th style="text-align: right;">NIOZ119_mb_b5_2</th>
<th style="text-align: right;">NIOZ120_mb_b229_2</th>
<th style="text-align: right;">NIOZ121_cc_b94_2</th>
<th style="text-align: right;">NIOZ121_mb_b48_2</th>
<th style="text-align: right;">NIOZ122_mb_b305_2</th>
<th style="text-align: right;">NIOZ122_mb_b319_2</th>
<th style="text-align: right;">NIOZ123_bs_b392_2</th>
<th style="text-align: right;">NIOZ123_bs_b5_2</th>
<th style="text-align: right;">NIOZ124_cc_b247_2</th>
<th style="text-align: right;">NIOZ124_mb_b130_2</th>
<th style="text-align: right;">NIOZ125_cc_b75_2</th>
<th style="text-align: right;">NIOZ125_mb_b178_2</th>
<th style="text-align: right;">NIOZ125_mb_b254_2</th>
<th style="text-align: right;">NIOZ126_mb_b137_2</th>
<th style="text-align: right;">NIOZ126_mb_b304_2</th>
<th style="text-align: right;">NIOZ126_mb_b401_2</th>
<th style="text-align: right;">NIOZ127_mb_b161_2</th>
<th style="text-align: right;">NIOZ127_mb_b282_2</th>
<th style="text-align: right;">NIOZ129_mb_b254_2</th>
<th style="text-align: right;">NIOZ129_mb_b262_2</th>
<th style="text-align: right;">NIOZ132_cc_b149_2</th>
<th style="text-align: right;">NIOZ132_cc_b51_2</th>
<th style="text-align: right;">NIOZ132_mb_b198_2</th>
<th style="text-align: right;">NIOZ132_mb_b260_2</th>
<th style="text-align: right;">NIOZ132_mb_b282_2</th>
<th style="text-align: right;">NIOZ132_mx_b314_2</th>
<th style="text-align: right;">NIOZ134_cc_b149_2</th>
<th style="text-align: right;">NIOZ134_mb_b293_2</th>
<th style="text-align: right;">NIOZ134_mb_b361_2</th>
<th style="text-align: right;">NIOZ134_mb_b41_2</th>
<th style="text-align: right;">NIOZ134_mx_b281_2</th>
<th style="text-align: right;">NIOZ136_cc_b15_2</th>
<th style="text-align: right;">NIOZ136_mb_b104_2</th>
<th style="text-align: right;">NIOZ136_mb_b226_2</th>
<th style="text-align: right;">NIOZ136_mb_b335_2</th>
<th style="text-align: right;">SRR2090153_bin1042</th>
<th style="text-align: right;">SRR2090153_bin461</th>
<th style="text-align: right;">SRR2090159_bin1129</th>
<th style="text-align: right;">SRR2090159_bin1288</th>
<th style="text-align: right;">SRR4028224_bin17</th>
<th style="text-align: right;">SRR5007147_bin71</th>
<th style="text-align: right;">U_76725</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CBM44</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">CE4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH119</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH130</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH95</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#order our data so that the bins start first with the bins from the basal group</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_wide <span class="ot">&lt;-</span> Counts_Table_wide[,Bin_order]</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co">#view data</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_wide)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">NIOZ132_cc_b51_2</th>
<th style="text-align: right;">NIOZ134_mx_b281_2</th>
<th style="text-align: right;">SRR2090153_bin1042</th>
<th style="text-align: right;">SRR2090153_bin461</th>
<th style="text-align: right;">SRR2090159_bin1129</th>
<th style="text-align: right;">SRR2090159_bin1288</th>
<th style="text-align: right;">GCA_002494525</th>
<th style="text-align: right;">GCA_002495465</th>
<th style="text-align: right;">GCA_002501985</th>
<th style="text-align: right;">SRR4028224_bin17</th>
<th style="text-align: right;">SRR5007147_bin71</th>
<th style="text-align: right;">U_76725</th>
<th style="text-align: right;">NIOZ124_cc_b247_2</th>
<th style="text-align: right;">NIOZ125_mb_b254_2</th>
<th style="text-align: right;">NIOZ129_mb_b262_2</th>
<th style="text-align: right;">NIOZ126_mb_b401_2</th>
<th style="text-align: right;">NIOZ122_mb_b319_2</th>
<th style="text-align: right;">NIOZ134_mb_b41_2</th>
<th style="text-align: right;">NIOZ132_mb_b282_2</th>
<th style="text-align: right;">NIOZ127_mb_b161_2</th>
<th style="text-align: right;">NIOZ123_bs_b5_2</th>
<th style="text-align: right;">NIOZ121_cc_b94_2</th>
<th style="text-align: right;">NIOZ136_cc_b15_2</th>
<th style="text-align: right;">GCA_002502135</th>
<th style="text-align: right;">NIOZ134_mb_b293_2</th>
<th style="text-align: right;">NIOZ132_mb_b260_2</th>
<th style="text-align: right;">NIOZ126_mb_b137_2</th>
<th style="text-align: right;">NIOZ129_mb_b254_2</th>
<th style="text-align: right;">NIOZ127_mb_b282_2</th>
<th style="text-align: right;">NIOZ122_mb_b305_2</th>
<th style="text-align: right;">NIOZ136_mb_b335_2</th>
<th style="text-align: right;">NIOZ132_mb_b198_2</th>
<th style="text-align: right;">NIOZ136_mb_b104_2</th>
<th style="text-align: right;">NIOZ125_mb_b178_2</th>
<th style="text-align: right;">NIOZ121_mb_b48_2</th>
<th style="text-align: right;">NIOZ134_cc_b149_2</th>
<th style="text-align: right;">NIOZ134_mb_b361_2</th>
<th style="text-align: right;">NIOZ136_mb_b226_2</th>
<th style="text-align: right;">NIOZ123_bs_b392_2</th>
<th style="text-align: right;">NIOZ124_mb_b130_2</th>
<th style="text-align: right;">NIOZ132_cc_b149_2</th>
<th style="text-align: right;">NIOZ125_cc_b75_2</th>
<th style="text-align: right;">NIOZ132_mx_b314_2</th>
<th style="text-align: right;">NIOZ120_mb_b229_2</th>
<th style="text-align: right;">NIOZ126_mb_b304_2</th>
<th style="text-align: right;">NIOZ119_mb_b5_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CBM44</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">CE4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH119</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH130</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH95</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If you run these three examples yourself, take not how different the speed is.</p>
</section>
</section>
<section id="generate-a-count-table-for-our-clusters-of-interest" class="level3" data-number="7.7.2">
<h3 data-number="7.7.2" class="anchored" data-anchor-id="generate-a-count-table-for-our-clusters-of-interest"><span class="header-section-number">7.7.2</span> Generate a count table for our clusters of interest</h3>
<p>Same as above, but now we want to know for our 4 aquifer genomes, how many have Gene Xx and show this as percent. I.e. if 1/4 genomes have a gene, then 25% have it.</p>
<p>First, lets merge in our taxa info into our count table, we need this to summarize our data by clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#merge the count table with mapping file to add in the taxa info (might take a while depending on size)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long_Tax <span class="ot">&lt;-</span> <span class="fu">merge</span>(Counts_Table_long, design_2[,<span class="fu">c</span>(<span class="st">"BinID"</span>, <span class="st">"ClusterName"</span>, <span class="st">"NrGenomes"</span>)], <span class="at">by =</span> <span class="st">"BinID"</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long_Tax)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">BinID</th>
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">count</th>
<th style="text-align: left;">ClusterName</th>
<th style="text-align: right;">NrGenomes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT2_Glycos_transf_2</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT4</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT66</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT83</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">K00012</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Next, whenever we have a value higher than one, we replace it with 1. That way we deal with our data like it is a presence/absence data. I.e. 0 = no genes present &amp; 1 = gene present</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert counts to presence/absence matrix (just using 0/1) (this is needed to calculate the percentage across clusters)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long_Tax<span class="sc">$</span>count[Counts_Table_long_Tax<span class="sc">$</span>count <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long_Tax)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">BinID</th>
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">count</th>
<th style="text-align: left;">ClusterName</th>
<th style="text-align: right;">NrGenomes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT2_Glycos_transf_2</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT4</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT66</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">GT83</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">GCA_002494525</td>
<td style="text-align: left;">K00012</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now, we can use tidyr to count of how many genomes in a cluster have a gene.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#count data and clean header</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long_Tax_sum <span class="ot">&lt;-</span> Counts_Table_long_Tax[,<span class="fu">c</span>(<span class="st">'ClusterName'</span>, <span class="st">'geneID'</span>,<span class="st">'NrGenomes'</span>, <span class="st">'count'</span>)] <span class="sc">%&gt;%</span> <span class="fu">count</span>(ClusterName, geneID, NrGenomes, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Counts_Table_long_Tax_sum) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ClusterName"</span>, <span class="st">"geneID"</span>, <span class="st">"NrGenomes"</span>, <span class="st">"quantity"</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long_Tax_sum)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ClusterName</th>
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">NrGenomes</th>
<th style="text-align: right;">quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">GT2_Glycos_transf_2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">GT4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">GT66</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">GT83</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">K00003</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">K00008</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Next, we want to calculate the percentage. I.e. in the first example, we have 4 aquifer genomes, two of which [FeFe]_Group_C3 (=50%).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate of the percentage to answer of the total genomes per cluster how many have a certain gene</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">#notice: if running for your own data check here that your percentage makes sense. I.e. we do not want values above 100</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>Counts_Table_long_Tax_sum<span class="sc">$</span>percentage <span class="ot">&lt;-</span> <span class="fu">round</span>(Counts_Table_long_Tax_sum<span class="sc">$</span>quantity<span class="sc">/</span>Counts_Table_long_Tax_sum<span class="sc">$</span>NrGenomes<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long_Tax_sum)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ClusterName</th>
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">NrGenomes</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: right;">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">GT2_Glycos_transf_2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">GT4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">GT66</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">GT83</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">K00003</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">K00008</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">75</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For printing this, we want to convert our long to a wide table by using <code>spread()</code>. Also, we want our geneIDs to be the new rownames and we do this by using the <code>rownames()</code> functions. We do this since some functions do not like to have characters in their dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert long to wide format and clean table (i.e. place the rownames)</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long_Tax_sum_wide <span class="ot">&lt;-</span> <span class="fu">spread</span>(Counts_Table_long_Tax_sum[,<span class="fu">c</span>(<span class="st">"geneID"</span>, <span class="st">"ClusterName"</span>, <span class="st">"percentage"</span>)], ClusterName, percentage)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co">#change the rownames</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Counts_Table_long_Tax_sum_wide) <span class="ot">&lt;-</span> Counts_Table_long_Tax_sum_wide<span class="sc">$</span>geneID</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co">#view data</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long_Tax_sum_wide)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">Aquifer (4)</th>
<th style="text-align: right;">Basal (2)</th>
<th style="text-align: right;">Clade1 (11)</th>
<th style="text-align: right;">Clade2 (23)</th>
<th style="text-align: right;">Marine (6)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CBM44</td>
<td style="text-align: left;">CBM44</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">CE4</td>
<td style="text-align: left;">CE4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH119</td>
<td style="text-align: left;">GH119</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH130</td>
<td style="text-align: left;">GH130</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH95</td>
<td style="text-align: left;">GH95</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">83</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When we change the rownames and view the data, we see that the geneID is now both in the rownames as well as the first column. Since that is a bit messy, we next remove the first column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#delete the first column</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long_Tax_sum_wide <span class="ot">&lt;-</span> Counts_Table_long_Tax_sum_wide[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long_Tax_sum_wide)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Aquifer (4)</th>
<th style="text-align: right;">Basal (2)</th>
<th style="text-align: right;">Clade1 (11)</th>
<th style="text-align: right;">Clade2 (23)</th>
<th style="text-align: right;">Marine (6)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CBM44</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">CE4</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH119</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH130</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH95</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">83</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now we see that we have NAs for genes that are not present in some of our clades. If we want to do more math then NAs are not helpful and we instead want to have a 0 there instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#replace NAs with 0</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long_Tax_sum_wide[<span class="fu">is.na</span>(Counts_Table_long_Tax_sum_wide)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long_Tax_sum_wide)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Aquifer (4)</th>
<th style="text-align: right;">Basal (2)</th>
<th style="text-align: right;">Clade1 (11)</th>
<th style="text-align: right;">Clade2 (23)</th>
<th style="text-align: right;">Marine (6)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CBM44</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">CE4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH119</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH130</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH95</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">83</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Finally, we want to sort our data, starting with the Basal clade and ending with the Black Sea Clades</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sort by cluster order (defined by the order of the mapping file)</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_long_Tax_sum_wide <span class="ot">&lt;-</span> Counts_Table_long_Tax_sum_wide[,Cluster_order]</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_long_Tax_sum_wide)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Basal (2)</th>
<th style="text-align: right;">Aquifer (4)</th>
<th style="text-align: right;">Marine (6)</th>
<th style="text-align: right;">Clade1 (11)</th>
<th style="text-align: right;">Clade2 (23)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CBM44</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">CE4</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH119</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH130</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH95</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GT2_Glyco_tranf_2_3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="merge-our-tables-with-the-mapping-data-we-have" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="merge-our-tables-with-the-mapping-data-we-have"><span class="header-section-number">7.8</span> Merge our tables with the mapping data we have</h2>
<p>Now, that we have our count tables both for the bins as well as for all the clusters, we now want to add some gene description and subset the data based on different categores.</p>
<section id="for-the-bins" class="level3" data-number="7.8.1">
<h3 data-number="7.8.1" class="anchored" data-anchor-id="for-the-bins"><span class="header-section-number">7.8.1</span> For the bins</h3>
<section id="add-gene-descriptions" class="level4" data-number="7.8.1.1">
<h4 data-number="7.8.1.1" class="anchored" data-anchor-id="add-gene-descriptions"><span class="header-section-number">7.8.1.1</span> Add gene descriptions</h4>
<p>Remember above, we made a list of descriptions that links all geneIDs with what is behind all the gene IDs? Now we want to add this info back in in order to print all the counts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#merge</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>Counts_Table_final <span class="ot">&lt;-</span> <span class="fu">merge</span>(All_Genes_Description, Counts_Table_wide, <span class="at">by.x=</span><span class="st">"Gene"</span>, <span class="at">by.y=</span><span class="st">"row.names"</span>, <span class="at">all.x =</span> T, <span class="at">sort =</span> F)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Counts_Table_final)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 6%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Description</th>
<th style="text-align: right;">NIOZ132_cc_b51_2</th>
<th style="text-align: right;">NIOZ134_mx_b281_2</th>
<th style="text-align: right;">SRR2090153_bin1042</th>
<th style="text-align: right;">SRR2090153_bin461</th>
<th style="text-align: right;">SRR2090159_bin1129</th>
<th style="text-align: right;">SRR2090159_bin1288</th>
<th style="text-align: right;">GCA_002494525</th>
<th style="text-align: right;">GCA_002495465</th>
<th style="text-align: right;">GCA_002501985</th>
<th style="text-align: right;">SRR4028224_bin17</th>
<th style="text-align: right;">SRR5007147_bin71</th>
<th style="text-align: right;">U_76725</th>
<th style="text-align: right;">NIOZ124_cc_b247_2</th>
<th style="text-align: right;">NIOZ125_mb_b254_2</th>
<th style="text-align: right;">NIOZ129_mb_b262_2</th>
<th style="text-align: right;">NIOZ126_mb_b401_2</th>
<th style="text-align: right;">NIOZ122_mb_b319_2</th>
<th style="text-align: right;">NIOZ134_mb_b41_2</th>
<th style="text-align: right;">NIOZ132_mb_b282_2</th>
<th style="text-align: right;">NIOZ127_mb_b161_2</th>
<th style="text-align: right;">NIOZ123_bs_b5_2</th>
<th style="text-align: right;">NIOZ121_cc_b94_2</th>
<th style="text-align: right;">NIOZ136_cc_b15_2</th>
<th style="text-align: right;">GCA_002502135</th>
<th style="text-align: right;">NIOZ134_mb_b293_2</th>
<th style="text-align: right;">NIOZ132_mb_b260_2</th>
<th style="text-align: right;">NIOZ126_mb_b137_2</th>
<th style="text-align: right;">NIOZ129_mb_b254_2</th>
<th style="text-align: right;">NIOZ127_mb_b282_2</th>
<th style="text-align: right;">NIOZ122_mb_b305_2</th>
<th style="text-align: right;">NIOZ136_mb_b335_2</th>
<th style="text-align: right;">NIOZ132_mb_b198_2</th>
<th style="text-align: right;">NIOZ136_mb_b104_2</th>
<th style="text-align: right;">NIOZ125_mb_b178_2</th>
<th style="text-align: right;">NIOZ121_mb_b48_2</th>
<th style="text-align: right;">NIOZ134_cc_b149_2</th>
<th style="text-align: right;">NIOZ134_mb_b361_2</th>
<th style="text-align: right;">NIOZ136_mb_b226_2</th>
<th style="text-align: right;">NIOZ123_bs_b392_2</th>
<th style="text-align: right;">NIOZ124_mb_b130_2</th>
<th style="text-align: right;">NIOZ132_cc_b149_2</th>
<th style="text-align: right;">NIOZ125_cc_b75_2</th>
<th style="text-align: right;">NIOZ132_mx_b314_2</th>
<th style="text-align: right;">NIOZ120_mb_b229_2</th>
<th style="text-align: right;">NIOZ126_mb_b304_2</th>
<th style="text-align: right;">NIOZ119_mb_b5_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">arCOG00570</td>
<td style="text-align: left;">“Geranylgeranyl_reductase,_flavoprotein”</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG01358</td>
<td style="text-align: left;">2-methylthioadenine_synthetase</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arCOG01169</td>
<td style="text-align: left;">Enolase</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG04245</td>
<td style="text-align: left;">Ribosomal_protein_S2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arCOG01728</td>
<td style="text-align: left;">“Predicted_class_III_extradiol_dioxygenase,_MEMO1_family”</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG00546</td>
<td style="text-align: left;">mRNA_degradation_ribonuclease_J1/J2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print (and beautify elsewhere)</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(Counts_Table_final, <span class="st">"../output_examples/Counts_Table_final.txt"</span>,  <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> F, <span class="at">row.names =</span> T, <span class="at">na =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="merging-with-the-arcog_table" class="level4" data-number="7.8.1.2">
<h4 data-number="7.8.1.2" class="anchored" data-anchor-id="merging-with-the-arcog_table"><span class="header-section-number">7.8.1.2</span> Merging with the arcog_table</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#merge</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>Arcog_Data <span class="ot">&lt;-</span> <span class="fu">merge</span>(Arcog_mapping, Counts_Table_wide, <span class="at">by.x=</span><span class="st">"arcog"</span>, <span class="at">by.y=</span><span class="st">"row.names"</span>, <span class="at">all.x =</span> T, <span class="at">sort =</span> F)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Arcog_Data)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 7%">
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">arcog</th>
<th style="text-align: left;">Pathway</th>
<th style="text-align: left;">GeneID</th>
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">COG</th>
<th style="text-align: left;">PFAM</th>
<th style="text-align: left;">CD</th>
<th style="text-align: left;">TIGR</th>
<th style="text-align: right;">NIOZ132_cc_b51_2</th>
<th style="text-align: right;">NIOZ134_mx_b281_2</th>
<th style="text-align: right;">SRR2090153_bin1042</th>
<th style="text-align: right;">SRR2090153_bin461</th>
<th style="text-align: right;">SRR2090159_bin1129</th>
<th style="text-align: right;">SRR2090159_bin1288</th>
<th style="text-align: right;">GCA_002494525</th>
<th style="text-align: right;">GCA_002495465</th>
<th style="text-align: right;">GCA_002501985</th>
<th style="text-align: right;">SRR4028224_bin17</th>
<th style="text-align: right;">SRR5007147_bin71</th>
<th style="text-align: right;">U_76725</th>
<th style="text-align: right;">NIOZ124_cc_b247_2</th>
<th style="text-align: right;">NIOZ125_mb_b254_2</th>
<th style="text-align: right;">NIOZ129_mb_b262_2</th>
<th style="text-align: right;">NIOZ126_mb_b401_2</th>
<th style="text-align: right;">NIOZ122_mb_b319_2</th>
<th style="text-align: right;">NIOZ134_mb_b41_2</th>
<th style="text-align: right;">NIOZ132_mb_b282_2</th>
<th style="text-align: right;">NIOZ127_mb_b161_2</th>
<th style="text-align: right;">NIOZ123_bs_b5_2</th>
<th style="text-align: right;">NIOZ121_cc_b94_2</th>
<th style="text-align: right;">NIOZ136_cc_b15_2</th>
<th style="text-align: right;">GCA_002502135</th>
<th style="text-align: right;">NIOZ134_mb_b293_2</th>
<th style="text-align: right;">NIOZ132_mb_b260_2</th>
<th style="text-align: right;">NIOZ126_mb_b137_2</th>
<th style="text-align: right;">NIOZ129_mb_b254_2</th>
<th style="text-align: right;">NIOZ127_mb_b282_2</th>
<th style="text-align: right;">NIOZ122_mb_b305_2</th>
<th style="text-align: right;">NIOZ136_mb_b335_2</th>
<th style="text-align: right;">NIOZ132_mb_b198_2</th>
<th style="text-align: right;">NIOZ136_mb_b104_2</th>
<th style="text-align: right;">NIOZ125_mb_b178_2</th>
<th style="text-align: right;">NIOZ121_mb_b48_2</th>
<th style="text-align: right;">NIOZ134_cc_b149_2</th>
<th style="text-align: right;">NIOZ134_mb_b361_2</th>
<th style="text-align: right;">NIOZ136_mb_b226_2</th>
<th style="text-align: right;">NIOZ123_bs_b392_2</th>
<th style="text-align: right;">NIOZ124_mb_b130_2</th>
<th style="text-align: right;">NIOZ132_cc_b149_2</th>
<th style="text-align: right;">NIOZ125_cc_b75_2</th>
<th style="text-align: right;">NIOZ132_mx_b314_2</th>
<th style="text-align: right;">NIOZ120_mb_b229_2</th>
<th style="text-align: right;">NIOZ126_mb_b304_2</th>
<th style="text-align: right;">NIOZ119_mb_b5_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">arCOG00009</td>
<td style="text-align: left;">E</td>
<td style="text-align: left;">PotE</td>
<td style="text-align: left;">Amino acid transporter</td>
<td style="text-align: left;">COG00531</td>
<td style="text-align: left;">pfam00324</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">TIGR00909</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG00014</td>
<td style="text-align: left;">G</td>
<td style="text-align: left;">RbsK</td>
<td style="text-align: left;">“Sugar kinase, ribokinase family”</td>
<td style="text-align: left;">COG00524</td>
<td style="text-align: left;">pfam00294</td>
<td style="text-align: left;">cd01174</td>
<td style="text-align: left;">TIGR02152</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arCOG00017</td>
<td style="text-align: left;">R</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">Predicted transcriptional regulator</td>
<td style="text-align: left;">COG02522</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG00018</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">Nnr2</td>
<td style="text-align: left;">“NAD(P)H-hydrate repair enzyme Nnr, NAD(P)H-hydrate dehydratase domain”</td>
<td style="text-align: left;">COG00063</td>
<td style="text-align: left;">“pfam03853,pfam01256”</td>
<td style="text-align: left;">cd01171</td>
<td style="text-align: left;">“TIGR00197,TIGR00196”</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arCOG00029</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">PyrE</td>
<td style="text-align: left;">Orotate phosphoribosyltransferase</td>
<td style="text-align: left;">COG00461</td>
<td style="text-align: left;">pfam00156</td>
<td style="text-align: left;">cd06223</td>
<td style="text-align: left;">TIGR00336</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG00030</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">Apt</td>
<td style="text-align: left;">Adenine/guanine phosphoribosyltransferase or related PRPP-binding protein</td>
<td style="text-align: left;">COG00503</td>
<td style="text-align: left;">pfam00156</td>
<td style="text-align: left;">cd06223</td>
<td style="text-align: left;">TIGR01090</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print (and beautify elsewhere)</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(Arcog_Data, <span class="st">"../output_examples/ArCOG_Data.txt"</span>,  <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> F, <span class="at">row.names =</span> T, <span class="at">na =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="merging-with-the-metabolism-metadata-file" class="level4" data-number="7.8.1.3">
<h4 data-number="7.8.1.3" class="anchored" data-anchor-id="merging-with-the-metabolism-metadata-file"><span class="header-section-number">7.8.1.3</span> Merging with the metabolism metadata file</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#merge</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>KEGG_Metabolism <span class="ot">&lt;-</span> <span class="fu">merge</span>(Metabolism_file_KEGG, Counts_Table_wide, <span class="at">by.x=</span><span class="st">"KO"</span>, <span class="at">by.y=</span><span class="st">"row.names"</span>, <span class="at">all.x =</span> T, <span class="at">sort =</span> F)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(KEGG_Metabolism)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 0%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">KO</th>
<th style="text-align: left;">IDs</th>
<th style="text-align: left;">pathway_A</th>
<th style="text-align: left;">order</th>
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Comment.Uniprot.comment</th>
<th style="text-align: right;">NIOZ132_cc_b51_2</th>
<th style="text-align: right;">NIOZ134_mx_b281_2</th>
<th style="text-align: right;">SRR2090153_bin1042</th>
<th style="text-align: right;">SRR2090153_bin461</th>
<th style="text-align: right;">SRR2090159_bin1129</th>
<th style="text-align: right;">SRR2090159_bin1288</th>
<th style="text-align: right;">GCA_002494525</th>
<th style="text-align: right;">GCA_002495465</th>
<th style="text-align: right;">GCA_002501985</th>
<th style="text-align: right;">SRR4028224_bin17</th>
<th style="text-align: right;">SRR5007147_bin71</th>
<th style="text-align: right;">U_76725</th>
<th style="text-align: right;">NIOZ124_cc_b247_2</th>
<th style="text-align: right;">NIOZ125_mb_b254_2</th>
<th style="text-align: right;">NIOZ129_mb_b262_2</th>
<th style="text-align: right;">NIOZ126_mb_b401_2</th>
<th style="text-align: right;">NIOZ122_mb_b319_2</th>
<th style="text-align: right;">NIOZ134_mb_b41_2</th>
<th style="text-align: right;">NIOZ132_mb_b282_2</th>
<th style="text-align: right;">NIOZ127_mb_b161_2</th>
<th style="text-align: right;">NIOZ123_bs_b5_2</th>
<th style="text-align: right;">NIOZ121_cc_b94_2</th>
<th style="text-align: right;">NIOZ136_cc_b15_2</th>
<th style="text-align: right;">GCA_002502135</th>
<th style="text-align: right;">NIOZ134_mb_b293_2</th>
<th style="text-align: right;">NIOZ132_mb_b260_2</th>
<th style="text-align: right;">NIOZ126_mb_b137_2</th>
<th style="text-align: right;">NIOZ129_mb_b254_2</th>
<th style="text-align: right;">NIOZ127_mb_b282_2</th>
<th style="text-align: right;">NIOZ122_mb_b305_2</th>
<th style="text-align: right;">NIOZ136_mb_b335_2</th>
<th style="text-align: right;">NIOZ132_mb_b198_2</th>
<th style="text-align: right;">NIOZ136_mb_b104_2</th>
<th style="text-align: right;">NIOZ125_mb_b178_2</th>
<th style="text-align: right;">NIOZ121_mb_b48_2</th>
<th style="text-align: right;">NIOZ134_cc_b149_2</th>
<th style="text-align: right;">NIOZ134_mb_b361_2</th>
<th style="text-align: right;">NIOZ136_mb_b226_2</th>
<th style="text-align: right;">NIOZ123_bs_b392_2</th>
<th style="text-align: right;">NIOZ124_mb_b130_2</th>
<th style="text-align: right;">NIOZ132_cc_b149_2</th>
<th style="text-align: right;">NIOZ125_cc_b75_2</th>
<th style="text-align: right;">NIOZ132_mx_b314_2</th>
<th style="text-align: right;">NIOZ120_mb_b229_2</th>
<th style="text-align: right;">NIOZ126_mb_b304_2</th>
<th style="text-align: right;">NIOZ119_mb_b5_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">K00362</td>
<td style="text-align: left;">ID14</td>
<td style="text-align: left;">Nitrogen</td>
<td style="text-align: left;">N2</td>
<td style="text-align: left;">nirB; nitrite reductase (NADH) large subunit [EC:1.7.1.15]</td>
<td style="text-align: left;">Dissimilatory</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">TIGR02374</td>
<td style="text-align: left;">ID15</td>
<td style="text-align: left;">Nitrogen</td>
<td style="text-align: left;">N2</td>
<td style="text-align: left;">“NirB, nitrite reductase [NAD(P)H]”</td>
<td style="text-align: left;">Dissimilatory</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TIGR02378</td>
<td style="text-align: left;">ID17</td>
<td style="text-align: left;">Nitrogen</td>
<td style="text-align: left;">N2</td>
<td style="text-align: left;">“NirD, nitrite reductase [NAD(P)H]”</td>
<td style="text-align: left;">Dissimilatory</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">K04748</td>
<td style="text-align: left;">ID31</td>
<td style="text-align: left;">no_pathway</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">norQ; nitric oxide reductase NorQ protein</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">K00376</td>
<td style="text-align: left;">ID36</td>
<td style="text-align: left;">Nitrogen</td>
<td style="text-align: left;">N5</td>
<td style="text-align: left;">nosZ; nitrous-oxide reductase [EC:1.7.2.4]</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">TIGR04246</td>
<td style="text-align: left;">ID37</td>
<td style="text-align: left;">Nitrogen</td>
<td style="text-align: left;">N5</td>
<td style="text-align: left;">“nosZ, nitrous-oxide reductase, Sec-dependent”</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(KEGG_Metabolism, <span class="st">"../output_examples/KEGG_Metabolism.txt"</span>,  <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> F, <span class="at">row.names =</span> T, <span class="at">na =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="for-the-clusters" class="level3" data-number="7.8.2">
<h3 data-number="7.8.2" class="anchored" data-anchor-id="for-the-clusters"><span class="header-section-number">7.8.2</span> For the clusters</h3>
<p>The process works exactly the same as above. So try by yourself if you can merge things ;-).</p>
</section>
</section>
<section id="plot-the-data-for-our-genes-of-interest" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="plot-the-data-for-our-genes-of-interest"><span class="header-section-number">7.9</span> Plot the data for our genes of interest</h2>
<p>Here, we are not interested in plotting all genes but just want to plot things that are listed under the lipid pathway.</p>
<p>Since we are only interested in the Lipid pathway for the genes of interest (the table, among others, also lists genes involved in informational processing), we first need to make a gene list of just the genes we are interested in.</p>
<p>New functions:</p>
<ul>
<li><code>subset()</code> = subsets a dataframe. Syntax –&gt; subset(dataframe, column, %in% pattern_we_look_for)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#subset genes of interest and clean factors</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>Genes_Lipids <span class="ot">&lt;-</span> <span class="fu">subset</span>(Genes_of_interest, Pathway_1 <span class="sc">%in%</span> <span class="st">"Lipids"</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>Genes_Lipids<span class="sc">$</span>Gene <span class="ot">&lt;-</span> <span class="fu">factor</span>(Genes_Lipids<span class="sc">$</span>Gene)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>Genes_Lipids<span class="sc">$</span>arcog <span class="ot">&lt;-</span> <span class="fu">factor</span>(Genes_Lipids<span class="sc">$</span>arcog)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#check how many genes we have</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Genes_Lipids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Genes_Lipids)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 21%">
<col style="width: 51%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Pathway_1</th>
<th style="text-align: left;">pathway_2</th>
<th style="text-align: left;">arcog</th>
<th style="text-align: left;">xx</th>
<th style="text-align: left;">Pathway</th>
<th style="text-align: left;">Gene_short</th>
<th style="text-align: left;">Gene_name</th>
<th style="text-align: left;">Comment</th>
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Order</th>
<th style="text-align: right;">Order2</th>
<th style="text-align: left;">Other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">262</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Mevalonate</td>
<td style="text-align: left;">arCOG01767</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">I</td>
<td style="text-align: left;">HmgB</td>
<td style="text-align: left;">3-hydroxy-3-methylglutaryl CoA synthase</td>
<td style="text-align: left;">Catalyzes the condensation of acetyl-CoA with acetoacetyl-CoA to form 3-hydroxy-3-methylglutaryl-CoA (HMG-CoA). Functions in the mevalonate (MVA) pathway</td>
<td style="text-align: left;">HmgB</td>
<td style="text-align: left;">Lipid_1</td>
<td style="text-align: right;">262</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">263</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Mevalonate</td>
<td style="text-align: left;">arCOG04260</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">I</td>
<td style="text-align: left;">HmgA</td>
<td style="text-align: left;">“3-hydroxy-3-methylglutaryl-coenzyme A reductase, HMG-CoA reductase”</td>
<td style="text-align: left;">Catalyzes the NADPH-dependent reductive deacylation of (S)-3-hydroxy-3-methylglutaryl-CoA (HMG-CoA) to (R)-mevalonate. Functions in the mevalonate (MVA) pathway</td>
<td style="text-align: left;">HmgA</td>
<td style="text-align: left;">Lipid_1</td>
<td style="text-align: right;">263</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">264</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Mevalonate</td>
<td style="text-align: left;">arCOG01028</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">I</td>
<td style="text-align: left;">MvK</td>
<td style="text-align: left;">Mevalonate kinase</td>
<td style="text-align: left;">Catalyzes the phosphorylation of (R)-mevalonate (MVA) to (R)-mevalonate 5-phosphate (MVAP).</td>
<td style="text-align: left;">MvK</td>
<td style="text-align: left;">Lipid_1</td>
<td style="text-align: right;">264</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">265</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Mevalonate</td>
<td style="text-align: left;">K18689</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">I</td>
<td style="text-align: left;">M3k</td>
<td style="text-align: left;">Mevalonate 3-kinase</td>
<td style="text-align: left;">Catalyzes the phosphorylation of mevalonate (MVA) to yield mevalonate-3-phosphate. Functions in an alternative mevalonate pathway</td>
<td style="text-align: left;">M3k</td>
<td style="text-align: left;">Lipid_1</td>
<td style="text-align: right;">265</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">266</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Mevalonate</td>
<td style="text-align: left;">arCOG01967</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">I</td>
<td style="text-align: left;">M3P5K</td>
<td style="text-align: left;">Mevalonate-3-phosphate 5-kinase</td>
<td style="text-align: left;">“Phosphorylates mevalonate 3-phosphate to form mevalonate 3,5-bisphosphate. Functions in an alternative mevalonate pathway”</td>
<td style="text-align: left;">M3P5K</td>
<td style="text-align: left;">Lipid_1</td>
<td style="text-align: right;">266</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">267</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Mevalonate</td>
<td style="text-align: left;">arCOG02937</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">I</td>
<td style="text-align: left;">mvaD</td>
<td style="text-align: left;">Diphosphomevalonate decarboxylase</td>
<td style="text-align: left;">Catalyzes the decarboxylation of mevalonate 5-phosphate (MVAP) to isopentenyl phosphate (IP). Functions in the mevalonate (MVA) pathway leading to IPP</td>
<td style="text-align: left;">mvaD</td>
<td style="text-align: left;">Lipid_1</td>
<td style="text-align: right;">267</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Next, we want to make sure that the order is ok. In this specific example, we manually defined two columns for ordering (Order and Order2). We sort based on these columns and make a vector to order our genes of interest and our pathways of interest. For the lipid genes we look at the mevalonate pathway and general lipid biosynthesis genes</p>
<ul>
<li>``length()``` - lets us check the length of a vector, here it allows us to see that we would expect 16 genes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define an order (we arange the dataframe based on two columsn, Order and Order2)</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>Genes_Lipids_order_temp <span class="ot">&lt;-</span> Genes_Lipids <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Order, Order2)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>Genes_Lipids_order <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unique</span>(Genes_Lipids_order_temp<span class="sc">$</span>Gene))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(Genes_Lipids_order)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>Genes_Lipids_order</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "HmgB"          "HmgA"          "MvK"           "M3k"          
 [5] "M3P5K"         "mvaD"          "Ipk"           "GFPS"         
 [9] "EgsA"          "GGGP_synthase" "UbiA"          "GGR"          
[13] "CarS"          "PgsA"          "ASS"           "Asd"          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The lipids belong to two different pathways, these 2 pathways we want to show in two separate heatmaps</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>Lipids_Pathway_order <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unique</span>(Genes_Lipids<span class="sc">$</span>pathway_2))</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>Lipids_Pathway_order</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mevalonate" "Lipids"    </code></pre>
</div>
</div>
<p>Now that we know what genes we are interested in, lets subset our original count table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#subset our original count table for genes of interest and clean factors</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>Genes_Lipids_counts <span class="ot">&lt;-</span> <span class="fu">subset</span>(Counts_Table_long_Tax_sum, geneID <span class="sc">%in%</span> <span class="fu">as.character</span>(Genes_Lipids<span class="sc">$</span>arcog))</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>Genes_Lipids_counts<span class="sc">$</span>geneID <span class="ot">&lt;-</span> <span class="fu">factor</span>(Genes_Lipids_counts<span class="sc">$</span>geneID)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#control that all went fine</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(Genes_Lipids_counts<span class="sc">$</span>geneID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Genes_Lipids_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60  5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Genes_Lipids_counts)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">ClusterName</th>
<th style="text-align: left;">geneID</th>
<th style="text-align: right;">NrGenomes</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: right;">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1924</td>
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">arCOG00476</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">1947</td>
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">arCOG00570</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1967</td>
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">arCOG00670</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="even">
<td style="text-align: left;">1968</td>
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">arCOG00671</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1997</td>
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">arCOG00860</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="even">
<td style="text-align: left;">2032</td>
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: left;">arCOG00982</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">75</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>With length we see that now we just have 15 genes. How can we find out what gene is missing?</p>
<ul>
<li><code>setdiff()</code> = we compare two vectors and print the elements that differ.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(Genes_Lipids<span class="sc">$</span>arcog, Genes_Lipids_counts<span class="sc">$</span>geneID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "K18689"</code></pre>
</div>
</div>
<p>We can see that we miss K18689. If we check our original annotations input, we can see that K18689 does not exist in that table. So we can nout pull information because of that. This gives a good example, why it is important to check your data as we do not know whether this is an issue with the code or what the problem could be.</p>
<hr>
<p>Now, since our count data does not know that we categorize our different genes into different pathways, lets add this info in with <code>merge()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add in metadata (from the pathway info)</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>Key_Lipids_genes_cluster <span class="ot">&lt;-</span> <span class="fu">merge</span>(Genes_Lipids_counts, Genes_Lipids, <span class="at">by.x =</span><span class="st">"geneID"</span>, <span class="at">by.y =</span> <span class="st">'arcog'</span> , <span class="at">all.x =</span> T )</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Key_Lipids_genes_cluster)), <span class="at">format=</span><span class="st">'markdown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 21%">
<col style="width: 42%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">geneID</th>
<th style="text-align: left;">ClusterName</th>
<th style="text-align: right;">NrGenomes</th>
<th style="text-align: right;">quantity</th>
<th style="text-align: right;">percentage</th>
<th style="text-align: left;">Pathway_1</th>
<th style="text-align: left;">pathway_2</th>
<th style="text-align: left;">xx</th>
<th style="text-align: left;">Pathway</th>
<th style="text-align: left;">Gene_short</th>
<th style="text-align: left;">Gene_name</th>
<th style="text-align: left;">Comment</th>
<th style="text-align: left;">Gene</th>
<th style="text-align: left;">Order</th>
<th style="text-align: right;">Order2</th>
<th style="text-align: left;">Other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">arCOG00476</td>
<td style="text-align: left;">Aquifer (4)</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">100</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">L</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">geranylgeranylglycerol-phosphate geranylgeranyltransferase [EC:2.5.1.42]</td>
<td style="text-align: left;">Notice: only the homologs identified in the aquifer MAGs harbor the characteristic DGGGP synthase domain (IPR023547)</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">Lipid_2</td>
<td style="text-align: right;">272</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG00476</td>
<td style="text-align: left;">Basal (2)</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">100</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">L</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">geranylgeranylglycerol-phosphate geranylgeranyltransferase [EC:2.5.1.42]</td>
<td style="text-align: left;">Notice: only the homologs identified in the aquifer MAGs harbor the characteristic DGGGP synthase domain (IPR023547)</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">Lipid_2</td>
<td style="text-align: right;">272</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">arCOG00476</td>
<td style="text-align: left;">Clade1 (11)</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">100</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">L</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">geranylgeranylglycerol-phosphate geranylgeranyltransferase [EC:2.5.1.42]</td>
<td style="text-align: left;">Notice: only the homologs identified in the aquifer MAGs harbor the characteristic DGGGP synthase domain (IPR023547)</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">Lipid_2</td>
<td style="text-align: right;">272</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG00476</td>
<td style="text-align: left;">Marine (6)</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">100</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">L</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">geranylgeranylglycerol-phosphate geranylgeranyltransferase [EC:2.5.1.42]</td>
<td style="text-align: left;">Notice: only the homologs identified in the aquifer MAGs harbor the characteristic DGGGP synthase domain (IPR023547)</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">Lipid_2</td>
<td style="text-align: right;">272</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">arCOG00476</td>
<td style="text-align: left;">Clade2 (23)</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">83</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">L</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">geranylgeranylglycerol-phosphate geranylgeranyltransferase [EC:2.5.1.42]</td>
<td style="text-align: left;">Notice: only the homologs identified in the aquifer MAGs harbor the characteristic DGGGP synthase domain (IPR023547)</td>
<td style="text-align: left;">UbiA</td>
<td style="text-align: left;">Lipid_2</td>
<td style="text-align: right;">272</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">arCOG00570</td>
<td style="text-align: left;">Clade2 (23)</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">96</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">Lipids</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">L</td>
<td style="text-align: left;">GGR</td>
<td style="text-align: left;">digeranylgeranylglycerophospholipid reductase [EC:1.3.1.101 1.3.7.11]</td>
<td style="text-align: left;">“reduction of 2,3-digeranylgeranylglycerophospholipids (unsaturated archaeols) into 2,3-diphytanylglycerophospholipids (saturated archaeols)”</td>
<td style="text-align: left;">GGR</td>
<td style="text-align: left;">Lipid_2</td>
<td style="text-align: right;">273</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="categorizing-data" class="level3" data-number="7.9.1">
<h3 data-number="7.9.1" class="anchored" data-anchor-id="categorizing-data"><span class="header-section-number">7.9.1</span> Categorizing data</h3>
<p>There are different ways to color code data. By default the way we do it, we use a gradual color scale from 0-100%. However, we could also define categories with the ifelse statement we learned before. Here, we define 4 categories (100%, 75-100 and, 33-75 and 0-33%)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define color code (not used for the current figure, but can be changed)</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">#here , we define 3 color levels, which sometimes is useful to show very clear cutoffs</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>Key_Lipids_genes_cluster<span class="sc">$</span>category <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Key_Lipids_genes_cluster<span class="sc">$</span>percentage <span class="sc">==</span> <span class="dv">100</span>, <span class="st">"1"</span>,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">ifelse</span>(Key_Lipids_genes_cluster<span class="sc">$</span>percentage <span class="sc">&gt;=</span> <span class="dv">75</span>, <span class="st">"0.75"</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">ifelse</span>(Key_Lipids_genes_cluster<span class="sc">$</span>percentage <span class="sc">&gt;=</span> <span class="dv">33</span>, <span class="st">"0.33"</span>, <span class="st">"0"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="order-our-data" class="level3" data-number="7.9.2">
<h3 data-number="7.9.2" class="anchored" data-anchor-id="order-our-data"><span class="header-section-number">7.9.2</span> Order our data</h3>
<p>Remember the annoying thing that R sorts alphabetically? Let’s make sure we ahve the order we want.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define order for the plot</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>Key_Lipids_genes_cluster<span class="sc">$</span>ClusterName2 <span class="ot">&lt;-</span>  <span class="fu">factor</span>(Key_Lipids_genes_cluster<span class="sc">$</span>ClusterName, <span class="at">levels =</span> <span class="fu">rev</span>(Cluster_order))</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>Key_Lipids_genes_cluster<span class="sc">$</span>Gene2 <span class="ot">&lt;-</span>  <span class="fu">factor</span>(Key_Lipids_genes_cluster<span class="sc">$</span>Gene, <span class="at">levels =</span> Genes_Lipids_order)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>Key_Lipids_genes_cluster<span class="sc">$</span>pathway_2b <span class="ot">&lt;-</span>  <span class="fu">factor</span>(Key_Lipids_genes_cluster<span class="sc">$</span>pathway_2, <span class="at">levels =</span> Lipids_Pathway_order)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting" class="level3" data-number="7.9.3">
<h3 data-number="7.9.3" class="anchored" data-anchor-id="plotting"><span class="header-section-number">7.9.3</span> Plotting</h3>
<p>In the example here, we use a gradual scale. If we would want to use our 4 categories we can use this code <code>#scale_fill_manual(values= c("white", "blue", "blue", "dodgerblue"))</code> and replacing the <code>fill = percentage</code> with <code>fill = category</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>p1_Lipids <span class="ot">&lt;-</span> </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Key_Lipids_genes_cluster, <span class="fu">aes</span>(<span class="at">x=</span>Gene2, <span class="at">y=</span>ClusterName2)) <span class="sc">+</span> </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> percentage)) <span class="sc">+</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> pathway_2b, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">scales=</span><span class="st">'free_x'</span>) <span class="sc">+</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_manual(values= c("white", "blue", "blue", "dodgerblue")) +</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>, <span class="at">fill=</span><span class="st">"Percentage"</span>) <span class="sc">+</span> </span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"left"</span>,</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>,<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.text.y=element_blank(),</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks=</span><span class="fu">element_blank</span>(),</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line=</span><span class="fu">element_blank</span>(),</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="st">"mm"</span>))</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>p1_Lipids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="parsing_output_from_annotations_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">levels</span>(Key_Lipids_genes_cluster<span class="sc">$</span>ClusterName2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["levels(Key_Lipids_genes_cluster$ClusterName2)"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"Clade2 (23)"},{"1":"Clade1 (11)"},{"1":"Marine (6)"},{"1":"Aquifer (4)"},{"1":"Basal (2)"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>p1_Lipids2 <span class="ot">&lt;-</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Key_Lipids_genes_cluster, <span class="fu">aes</span>(<span class="at">x=</span>Gene2, <span class="at">y=</span>ClusterName2)) <span class="sc">+</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> percentage)) <span class="sc">+</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> pathway_2b, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">scales=</span><span class="st">'free_x'</span>) <span class="sc">+</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_manual(values= c("white", "blue", "blue", "dodgerblue")) +</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>, <span class="at">fill=</span><span class="st">"Percentage"</span>) <span class="sc">+</span> </span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"left"</span>,</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>,<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.text.y=element_blank(),</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks=</span><span class="fu">element_blank</span>(),</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line=</span><span class="fu">element_blank</span>(),</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="st">"mm"</span>))</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>p1_Lipids2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="parsing_output_from_annotations_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If we plot with facets we can sometimes have the problem that different genes have different widths. We can correct this behaviour with ggplotGrob.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert ggplot object to grob object (used to rescale plot)</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>gp_lipid <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(p1_Lipids2)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># optional: take a look at the grob object's layout</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>gtable<span class="sc">::</span><span class="fu">gtable_show_layout</span>(gp_lipid)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get gtable columns corresponding to the facets (5 &amp; 9, in this case)</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>facet.columns <span class="ot">&lt;-</span> gp_lipid<span class="sc">$</span>layout<span class="sc">$</span>l[<span class="fu">grepl</span>(<span class="st">"panel"</span>, gp_lipid<span class="sc">$</span>layout<span class="sc">$</span>name)]</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get the number of unique x-axis values per facet (1 &amp; 3, in this case)</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>x.var <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">ggplot_build</span>(p1_Lipids)<span class="sc">$</span>layout<span class="sc">$</span>panel_scales_x,</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">function</span>(l) <span class="fu">length</span>(l<span class="sc">$</span>range<span class="sc">$</span>range))</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="co"># change the relative widths of the facet columns based on</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="co"># how many unique x-axis values are in each facet</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>gp_lipid<span class="sc">$</span>widths[facet.columns] <span class="ot">&lt;-</span> gp_lipid<span class="sc">$</span>widths[facet.columns] <span class="sc">*</span> x.var</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot result</span></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.draw</span>(gp_lipid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="parsing_output_from_annotations_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pdf("2_Output/Figure_S64.pdf", paper="special", family="sans",width=8, height=7, useDingbats=FALSE)</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co">#grid::grid.draw(gp_lipid)</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off() </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this example we see that only the aquifer and the basal clade have all required genes for the mevalonate pathway and the lipid pathway that is required to make a key archaeal lipid.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../code/plotting_basics.html" class="pagination-link" aria-label="Basic plotting">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Basic plotting</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../code/2_misc.html" class="pagination-link" aria-label="Miscellaneous">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Miscellaneous</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>